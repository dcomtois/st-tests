
# -----------------  with-by.R ------------------------------------
> suppressPackageStartupMessages(library(summarytools))

> suppressPackageStartupMessages(library(dplyr))

> options(tibble.print_max = Inf)

# -----------------  with
> w1 <- with(tobacco, freq(gender, plain.ascii = F, weights = samp.wgts))

> view(w1, file = "01-with.md")
Switching method to 'pander'
Changing style to 'rmarkdown' for improved markdown compatibility
Output file written

> view(w1, file = "01-with.html")
Output file written

> (w2 <- with(tobacco, descr(BMI, transpose = TRUE)))
Кол-венный показатель распределения  
tobacco$BMI  
Кол-во: 1000  

            сред. знач.   ст. откл.    Mин      Q1   Mедиана      Q3    Mакс    MAD    IQR     CV
--------- ------------- ----------- ------ ------- --------- ------- ------- ------ ------ ------
      BMI         25.73        4.49   8.83   22.93     25.62   28.65   39.44   4.18   5.72   0.17

Table: Table continues below

 

            асимметрия   SE.асимметрия   эксцесс   Цифр. корр   Проц. корр
--------- ------------ --------------- --------- ------------ ------------
      BMI         0.02            0.08      0.26       974.00        97.40

> view(w2, footnote = "with, transpose", file = "02-with-transposed.html")
Output file written

> view(with(tobacco, ctable(gender, diseased, style = "grid")), method = "pander")
Кросс-табуляция, пропорции по рядам  
gender * diseased  
Верт. таблица: tobacco  

+--------+----------+-------------+-------------+---------------+
|        | diseased |         Yes |          No |         сумма |
+--------+----------+-------------+-------------+---------------+
| gender |          |             |             |               |
+--------+----------+-------------+-------------+---------------+
|      F |          | 111 (22.7%) | 378 (77.3%) |  489 (100.0%) |
+--------+----------+-------------+-------------+---------------+
|      M |          | 110 (22.5%) | 379 (77.5%) |  489 (100.0%) |
+--------+----------+-------------+-------------+---------------+
|   <NA> |          |   3 (13.6%) |  19 (86.4%) |   22 (100.0%) |
+--------+----------+-------------+-------------+---------------+
|  сумма |          | 224 (22.4%) | 776 (77.6%) | 1000 (100.0%) |
+--------+----------+-------------+-------------+---------------+

> (w3 <- with(tobacco, ctable(gender, diseased, style = "grid", prop = "C")))
Кросс-табуляция, пропорции по столбцам  
gender * diseased  
Верт. таблица: tobacco  

+--------+----------+--------------+--------------+---------------+
|        | diseased |          Yes |           No |         сумма |
+--------+----------+--------------+--------------+---------------+
| gender |          |              |              |               |
+--------+----------+--------------+--------------+---------------+
|      F |          | 111 ( 49.6%) | 378 ( 48.7%) |  489 ( 48.9%) |
+--------+----------+--------------+--------------+---------------+
|      M |          | 110 ( 49.1%) | 379 ( 48.8%) |  489 ( 48.9%) |
+--------+----------+--------------+--------------+---------------+
|   <NA> |          |    3 ( 1.3%) |   19 ( 2.4%) |    22 ( 2.2%) |
+--------+----------+--------------+--------------+---------------+
|  сумма |          | 224 (100.0%) | 776 (100.0%) | 1000 (100.0%) |
+--------+----------+--------------+--------------+---------------+

> view(w3, method = "browser", footnote = "with, prop = c", file = "03-with-col-props.html")
Output file written

# -----------------  by
> bf1 <- stby(data = tobacco$diseased, INDICES = tobacco$smoker, FUN = freq)

> view(bf1, 'pander')
Частота  
tobacco$diseased  
Тип: склейка  
Переменные: smoker = Yes  

              Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- ------- --------- --------------- --------- --------------------
        Yes     125     41.95           41.95     41.95                41.95
         No     173     58.05          100.00     58.05               100.00
       <NA>       0                                0.00               100.00
      сумма     298    100.00          100.00    100.00               100.00

Переменные: smoker = No  

              Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- ------- --------- --------------- --------- --------------------
        Yes      99     14.10           14.10     14.10                14.10
         No     603     85.90          100.00     85.90               100.00
       <NA>       0                                0.00               100.00
      сумма     702    100.00          100.00    100.00               100.00

> view(bf1, 'pander', headings = FALSE, plain.ascii = FALSE)
**Переменные:** smoker = Yes  

      &nbsp;   Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
------------ ------- --------- --------------- --------- --------------------
     **Yes**     125     41.95           41.95     41.95                41.95
      **No**     173     58.05          100.00     58.05               100.00
  **\<NA\>**       0                                0.00               100.00
   **сумма**     298    100.00          100.00    100.00               100.00

**Переменные:** smoker = No  

      &nbsp;   Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
------------ ------- --------- --------------- --------- --------------------
     **Yes**      99     14.10           14.10     14.10                14.10
      **No**     603     85.90          100.00     85.90               100.00
  **\<NA\>**       0                                0.00               100.00
   **сумма**     702    100.00          100.00    100.00               100.00

> print(bf1)
Частота  
tobacco$diseased  
Тип: склейка  
Переменные: smoker = Yes  

              Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- ------- --------- --------------- --------- --------------------
        Yes     125     41.95           41.95     41.95                41.95
         No     173     58.05          100.00     58.05               100.00
       <NA>       0                                0.00               100.00
      сумма     298    100.00          100.00    100.00               100.00

Переменные: smoker = No  

              Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- ------- --------- --------------- --------- --------------------
        Yes      99     14.10           14.10     14.10                14.10
         No     603     85.90          100.00     85.90               100.00
       <NA>       0                                0.00               100.00
      сумма     702    100.00          100.00    100.00               100.00

> view(bf1, file = "04-by-freq.html", missing = "xxxx")
Output file written
Output file appended

# -----------------  with + by
> label(tobacco$BMI) <- "Body Mass Index"

> label(tobacco$diseased) <- "Subject has illness"

> view(stby(data = tobacco$diseased, INDICES = tobacco$smoker, FUN = freq), file = "05-with-and-by-freq.html")
Output file written
Output file appended

> view(stby(data = tobacco$BMI, INDICES = tobacco$gender, FUN = descr), file = "06-with-and-by-descr.md")
Switching method to 'pander'
Setting 'plain.ascii' to FALSE and Changing style to 'rmarkdown' for improved markdown compatibility
Output file written

> bf2 <- stby(iris$Species, iris$Sepal.Length > mean(iris$Sepal.Length), freq)

> view(bf2, 'pander')
Частота  
iris$Species  
Тип: склейка  
Переменные: Sepal.Length > mean(Sepal.Length) = FALSE  

                   Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
---------------- ------- --------- --------------- --------- --------------------
          setosa      50     62.50           62.50     62.50                62.50
      versicolor      24     30.00           92.50     30.00                92.50
       virginica       6      7.50          100.00      7.50               100.00
            <NA>       0                                0.00               100.00
           сумма      80    100.00          100.00    100.00               100.00

Переменные: Sepal.Length > mean(Sepal.Length) = TRUE  

                   Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
---------------- ------- --------- --------------- --------- --------------------
          setosa       0      0.00            0.00      0.00                 0.00
      versicolor      26     37.14           37.14     37.14                37.14
       virginica      44     62.86          100.00     62.86               100.00
            <NA>       0                                0.00               100.00
           сумма      70    100.00          100.00    100.00               100.00

> view(bf2, method = "browser", footnote = "condition for by", file = "07-by-calculated-freq.html")
Output file written
Output file appended

> bd1 <- stby(data = tobacco$BMI, INDICES = tobacco$gender, FUN = descr, style = "grid")

> view(bd1, headings = FALSE, method = "browser", footnote = "by, no headings", file = "08-by-descr-no-head.html")
Output file written

> view(bd1, method = 'pander')
Кол-венный показатель распределения  
BMI группа gender  
Верт. таблица: tobacco  
Ярлык: Body Mass Index  
Кол-во: 489  

                           F        M
------------------- -------- --------
        сред. знач.    26.10    25.31
          ст. откл.     4.95     3.98
                Mин     9.01     8.83
                 Q1    22.98    22.52
            Mедиана    25.87    25.14
                 Q3    29.48    27.96
               Mакс    39.44    36.76
                MAD     4.75     4.02
                IQR     6.49     5.44
                 CV     0.19     0.16
         асимметрия    -0.02    -0.04
      SE.асимметрия     0.11     0.11
            эксцесс     0.09     0.17
         Цифр. корр   475.00   477.00
         Проц. корр    97.14    97.55

> bd2 <- stby(data = tobacco, INDICES = tobacco$gender, FUN = descr)

> view(bd2, method = "browser", file = "09-by-descr.html")
Non-numerical variable(s) ignored: gender, age.gr, smoker, diseased, disease
Output file written
Output file appended

> view(bd2, method = "pander", file = "09-by-descr-view.md")
Setting 'plain.ascii' to FALSE and Changing style to 'rmarkdown' for improved markdown compatibility
Non-numerical variable(s) ignored: gender, age.gr, smoker, diseased, disease
Output file written
Setting 'plain.ascii' to FALSE and Changing style to 'rmarkdown' for improved markdown compatibility
Output file appended

> label(tobacco) <- "Blabla"

> bd3 <- stby(data = tobacco, INDICES = tobacco$gender, FUN = descr)

> st_options(display.labels = FALSE)

> view(bd3, display.labels = T, method = "browser", footnote = "override option disp.labels = F", file = "10-by-descr.html")
Non-numerical variable(s) ignored: gender, age.gr, smoker, diseased, disease
Output file written
Output file appended

> print(bd3, file = "10-by-descr.md")
Setting 'plain.ascii' to FALSE and Changing style to 'rmarkdown' for improved markdown compatibility
Non-numerical variable(s) ignored: gender, age.gr, smoker, diseased, disease
Output file written
Setting 'plain.ascii' to FALSE and Changing style to 'rmarkdown' for improved markdown compatibility
Output file appended

> attach(tobacco)

> bd4 <- stby(data = BMI, INDICES = gender, FUN = descr)

> view(bd4, method = "browser", footnote = "stand-alone variable", file = "11-by-descr-standalone-var.html")
Output file written

> print(bd4, file = "11-by-descr-standalone-var.md")
Setting 'plain.ascii' to FALSE and Changing style to 'rmarkdown' for improved markdown compatibility
Output file written

> detach(tobacco)

# -----------------  cas particulier - by, 1 groupe seul.
> (b8 <- stby(iris, !is.na(iris$Species), descr))
Non-numerical variable(s) ignored: Species
Кол-венный показатель распределения  
iris  
Переменные: !is.na(Species) = TRUE  
Кол-во: 150  

                      Petal.Length   Petal.Width   Sepal.Length   Sepal.Width
------------------- -------------- ------------- -------------- -------------
        сред. знач.           3.76          1.20           5.84          3.06
          ст. откл.           1.77          0.76           0.83          0.44
                Mин           1.00          0.10           4.30          2.00
                 Q1           1.60          0.30           5.10          2.80
            Mедиана           4.35          1.30           5.80          3.00
                 Q3           5.10          1.80           6.40          3.30
               Mакс           6.90          2.50           7.90          4.40
                MAD           1.85          1.04           1.04          0.44
                IQR           3.50          1.50           1.30          0.50
                 CV           0.47          0.64           0.14          0.14
         асимметрия          -0.27         -0.10           0.31          0.31
      SE.асимметрия           0.20          0.20           0.20          0.20
            эксцесс          -1.42         -1.36          -0.61          0.14
         Цифр. корр         150.00        150.00         150.00        150.00
         Проц. корр         100.00        100.00         100.00        100.00

> view(with(tobacco, descr(BMI, transpose = TRUE)), method = "browser", footnote = "with, transpose", file = "12.html")
Output file written

> attach(tobacco)

> view(stby(data = BMI, INDICES = gender, FUN = descr), method = "browser", file = "13.html") 
Output file written

> view(stby(data = BMI, INDICES = gender, FUN = descr), method = "pander", style = "rmarkdown") 
### Кол-венный показатель распределения  
#### BMI группа gender  
**Кол-во:** 489  

|            &nbsp; |      F |      M |
|------------------:|-------:|-------:|
|   **сред. знач.** |  26.10 |  25.31 |
|     **ст. откл.** |   4.95 |   3.98 |
|           **Mин** |   9.01 |   8.83 |
|            **Q1** |  22.98 |  22.52 |
|       **Mедиана** |  25.87 |  25.14 |
|            **Q3** |  29.48 |  27.96 |
|          **Mакс** |  39.44 |  36.76 |
|           **MAD** |   4.75 |   4.02 |
|           **IQR** |   6.49 |   5.44 |
|            **CV** |   0.19 |   0.16 |
|    **асимметрия** |  -0.02 |  -0.04 |
| **SE.асимметрия** |   0.11 |   0.11 |
|       **эксцесс** |   0.09 |   0.17 |
|    **Цифр. корр** | 475.00 | 477.00 |
|    **Проц. корр** |  97.14 |  97.55 |

> view(stby(data = BMI, INDICES = gender, FUN = descr), method = "render") 
<div class="container st-container">
  <h3>&#01050;&#01086;&#01083;-&#01074;&#01077;&#01085;&#01085;&#01099;&#01081; &#01087;&#01086;&#01082;&#01072;&#01079;&#01072;&#01090;&#01077;&#01083;&#01100; &#01088;&#01072;&#01089;&#01087;&#01088;&#01077;&#01076;&#01077;&#01083;&#01077;&#01085;&#01080;&#01103;</h3>
  <h4> BMI &#01075;&#01088;&#01091;&#01087;&#01087;&#01072; gender </h4>
  <strong>&#01050;&#01086;&#01083;-&#01074;&#01086;</strong>: 489
  <br/>
  <table class="table table-bordered table-striped st-table st-table-bordered st-table-striped st-descr-table ">
  <thead>
    <tr>
      <th></th>
      <th align="center" class="st-protect-top-border">F</th>
      <th align="center" class="st-protect-top-border">M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <strong>&#01089;&#01088;&#01077;&#01076;. &#01079;&#01085;&#01072;&#01095;.</strong></td>
      <td><span>26.10</span></td>
      <td><span>25.31</span></td>
    </tr>
    <tr>
      <td>
        <strong>&#01089;&#01090;. &#01086;&#01090;&#01082;&#01083;.</strong></td>
      <td><span>4.95</span></td>
      <td><span>3.98</span></td>
    </tr>
    <tr>
      <td>
        <strong>M&#01080;&#01085;</strong></td>
      <td><span>9.01</span></td>
      <td><span>8.83</span></td>
    </tr>
    <tr>
      <td>
        <strong>Q1</strong></td>
      <td><span>22.98</span></td>
      <td><span>22.52</span></td>
    </tr>
    <tr>
      <td>
        <strong>M&#01077;&#01076;&#01080;&#01072;&#01085;&#01072;</strong></td>
      <td><span>25.87</span></td>
      <td><span>25.14</span></td>
    </tr>
    <tr>
      <td>
        <strong>Q3</strong></td>
      <td><span>29.48</span></td>
      <td><span>27.96</span></td>
    </tr>
    <tr>
      <td>
        <strong>M&#01072;&#01082;&#01089;</strong></td>
      <td><span>39.44</span></td>
      <td><span>36.76</span></td>
    </tr>
    <tr>
      <td>
        <strong>MAD</strong></td>
      <td><span>4.75</span></td>
      <td><span>4.02</span></td>
    </tr>
    <tr>
      <td>
        <strong>IQR</strong></td>
      <td><span>6.49</span></td>
      <td><span>5.44</span></td>
    </tr>
    <tr>
      <td>
        <strong>CV</strong></td>
      <td><span>0.19</span></td>
      <td><span>0.16</span></td>
    </tr>
    <tr>
      <td>
        <strong>&#01072;&#01089;&#01080;&#01084;&#01084;&#01077;&#01090;&#01088;&#01080;&#01103;</strong></td>
      <td><span>-0.02</span></td>
      <td><span>-0.04</span></td>
    </tr>
    <tr>
      <td>
        <strong>SE.&#01072;&#01089;&#01080;&#01084;&#01084;&#01077;&#01090;&#01088;&#01080;&#01103;</strong></td>
      <td><span>0.11</span></td>
      <td><span>0.11</span></td>
    </tr>
    <tr>
      <td>
        <strong>&#01101;&#01082;&#01089;&#01094;&#01077;&#01089;&#01089;</strong></td>
      <td><span>0.09</span></td>
      <td><span>0.17</span></td>
    </tr>
    <tr>
      <td>
        <strong>&#01062;&#01080;&#01092;&#01088;. &#01082;&#01086;&#01088;&#01088;</strong></td>
      <td><span>475</span></td>
      <td><span>477</span></td>
    </tr>
    <tr>
      <td>
        <strong>&#01055;&#01088;&#01086;&#01094;. &#01082;&#01086;&#01088;&#01088;</strong></td>
      <td><span>97.14</span></td>
      <td><span>97.55</span></td>
    </tr>
  </tbody>
</table>
  <p>&#01057;&#01075;&#01077;&#01085;&#01077;&#01088;&#01080;&#01088;&#01086;&#01074;&#01072;&#01085;&#01086; <a href='https://github.com/dcomtois/summarytools'>summarytools</a> 0.9.7 (<a href='https://www.r-project.org/'>R</a> &#01074;&#01077;&#01088;&#01089;&#01080;&#01103; 4.0.2)<br/>2020-08-17</p>
</div>

> detach(tobacco)

> stby(tobacco, tobacco$gender, dfSummary)
Сводка кадровых данных  
tobacco  
Переменные: gender = F  
Измерения: 489 x 9  
Дупликаты: 0  

--------------------------------------------------------------------------------------------------------------------------------------
№   Переменная     Статистика / Значения              Частота (% действительных)   Диаграмма              Kорректное   Отсутствующее  
--- -------------- ---------------------------------- ---------------------------- ---------------------- ------------ ---------------
1   gender         1. F                               489 (100.0%)                 IIIIIIIIIIIIIIIIIIII   489          0              
    [factor]       2. M                                 0 (  0.0%)                                        (100%)       (0%)           

2   age            сред. знач. (с.о.) : 49.6 (18.3)   63 уникальные значения       :     . . .   : . :    475          14             
    [numeric]      mин < мед < mакс:                                               : : : : : : : : : :    (97.14%)     (2.86%)        
                   18 < 50 < 80                                                    : : : : : : : : : :                                
                   IQR (CV) : 32 (0.4)                                             : : : : : : : : : :                                
                                                                                   : : : : : : : : : :                                

3   age.gr         1. 18-34                           123 (25.9%)                  IIIII                  475          14             
    [factor]       2. 35-50                           118 (24.8%)                  IIII                   (97.14%)     (2.86%)        
                   3. 51-70                           157 (33.1%)                  IIIIII                                             
                   4. 71 +                             77 (16.2%)                  III                                                

4   BMI            сред. знач. (с.о.) : 26.1 (4.9)    475 уникальные значения              :              475          14             
    [numeric]      mин < мед < mакс:                                                     : :              (97.14%)     (2.86%)        
                   9 < 25.9 < 39.4                                                       : : .                                        
                   IQR (CV) : 6.5 (0.2)                                                . : : :                                        
                                                                                       : : : : .                                      

5   smoker         1. Yes                             147 (30.1%)                  IIIIII                 489          0              
    [factor]       2. No                              342 (69.9%)                  IIIIIIIIIIIII          (100%)       (0%)           

6   cigs.per.day   сред. знач. (с.о.) : 6.9 (12)      37 уникальные значения       :                      468          21             
    [numeric]      mин < мед < mакс:                                               :                      (95.71%)     (4.29%)        
                   0 < 0 < 40                                                      :                                                  
                   IQR (CV) : 10.2 (1.8)                                           :                                                  
                                                                                   : . . .   . . .                                    

7   diseased       1. Yes                             111 (22.7%)                  IIII                   489          0              
    [factor]       2. No                              378 (77.3%)                  IIIIIIIIIIIIIII        (100%)       (0%)           

8   disease        1. Hypertension                    18 (16.5%)                   III                    109          380            
    [character]    2. Cancer                          16 (14.7%)                   II                     (22.29%)     (77.71%)       
                   3. Cholesterol                     10 ( 9.2%)                   I                                                  
                   4. Heart                            9 ( 8.3%)                   I                                                  
                   5. Pulmonary                        9 ( 8.3%)                   I                                                  
                   6. Diabetes                         8 ( 7.3%)                   I                                                  
                   7. Musculoskeletal                  8 ( 7.3%)                   I                                                  
                   8. Hypotension                      7 ( 6.4%)                   I                                                  
                   9. Neurological                     7 ( 6.4%)                   I                                                  
                   10. Vision                          6 ( 5.5%)                   I                                                  
                   [ 3 остальные ]                    11 (10.1%)                   II                                                 

9   samp.wgts      сред. знач. (с.о.) : 1 (0.1)       0.86!: 131 (26.8%)           IIIII                  489          0              
    [numeric]      mин < мед < mакс:                  1.04!: 120 (24.5%)           IIII                   (100%)       (0%)           
                   0.9 < 1 < 1.1                      1.05!: 160 (32.7%)           IIIIII                                             
                   IQR (CV) : 0.2 (0.1)               1.06!:  78 (16.0%)           III                                                
                                                      ! округлённое                                                                   
--------------------------------------------------------------------------------------------------------------------------------------

Переменные: gender = M  
Измерения: 489 x 9  
Дупликаты: 2  

--------------------------------------------------------------------------------------------------------------------------------------
№   Переменная     Статистика / Значения              Частота (% действительных)   Диаграмма              Kорректное   Отсутствующее  
--- -------------- ---------------------------------- ---------------------------- ---------------------- ------------ ---------------
1   gender         1. F                                 0 (  0.0%)                                        489          0              
    [factor]       2. M                               489 (100.0%)                 IIIIIIIIIIIIIIIIIIII   (100%)       (0%)           

2   age            сред. знач. (с.о.) : 49.6 (18.3)   63 уникальные значения             .     .   . :    478          11             
    [numeric]      mин < мед < mакс:                                               : : : : :   : : : :    (97.75%)     (2.25%)        
                   18 < 49.5 < 80                                                  : : : : : : : : : :                                
                   IQR (CV) : 32 (0.4)                                             : : : : : : : : : :                                
                                                                                   : : : : : : : : : :                                

3   age.gr         1. 18-34                           130 (27.2%)                  IIIII                  478          11             
    [factor]       2. 35-50                           118 (24.7%)                  IIII                   (97.75%)     (2.25%)        
                   3. 51-70                           151 (31.6%)                  IIIIII                                             
                   4. 71 +                             79 (16.5%)                  III                                                

4   BMI            сред. знач. (с.о.) : 25.3 (4)      477 уникальные значения                : .          477          12             
    [numeric]      mин < мед < mакс:                                                         : :          (97.55%)     (2.45%)        
                   8.8 < 25.1 < 36.8                                                       : : : .                                    
                   IQR (CV) : 5.4 (0.2)                                                    : : : : .                                  
                                                                                         : : : : : :                                  

5   smoker         1. Yes                             143 (29.2%)                  IIIII                  489          0              
    [factor]       2. No                              346 (70.8%)                  IIIIIIIIIIIIII         (100%)       (0%)           

6   cigs.per.day   сред. знач. (с.о.) : 6.7 (11.8)    36 уникальные значения       :                      475          14             
    [numeric]      mин < мед < mакс:                                               :                      (97.14%)     (2.86%)        
                   0 < 0 < 40                                                      :                                                  
                   IQR (CV) : 11 (1.8)                                             :                                                  
                                                                                   :   .   . . . .                                    

7   diseased       1. Yes                             110 (22.5%)                  IIII                   489          0              
    [factor]       2. No                              379 (77.5%)                  IIIIIIIIIIIIIII        (100%)       (0%)           

8   disease        1. Cancer                          18 (16.4%)                   III                    110          379            
    [character]    2. Hypertension                    17 (15.5%)                   III                    (22.49%)     (77.51%)       
                   3. Cholesterol                     11 (10.0%)                   II                                                 
                   4. Heart                           11 (10.0%)                   II                                                 
                   5. Pulmonary                       11 (10.0%)                   II                                                 
                   6. Musculoskeletal                 10 ( 9.1%)                   I                                                  
                   7. Hearing                          9 ( 8.2%)                   I                                                  
                   8. Digestive                        7 ( 6.4%)                   I                                                  
                   9. Diabetes                         5 ( 4.5%)                                                                      
                   10. Hypotension                     4 ( 3.6%)                                                                      
                   [ 3 остальные ]                     7 ( 6.4%)                   I                                                  

9   samp.wgts      сред. знач. (с.о.) : 1 (0.1)       0.86!: 131 (26.8%)           IIIII                  489          0              
    [numeric]      mин < мед < mакс:                  1.04!: 124 (25.4%)           IIIII                  (100%)       (0%)           
                   0.9 < 1 < 1.1                      1.05!: 155 (31.7%)           IIIIII                                             
                   IQR (CV) : 0.2 (0.1)               1.06!:  79 (16.2%)           III                                                
                                                      ! округлённое                                                                   
--------------------------------------------------------------------------------------------------------------------------------------

> stby(tobacco, tobacco$gender, descr)
Non-numerical variable(s) ignored: gender, age.gr, smoker, diseased, disease
Кол-венный показатель распределения  
tobacco  
Переменные: gender = F  
Кол-во: 489  

                         age      BMI   cigs.per.day   samp.wgts
------------------- -------- -------- -------------- -----------
        сред. знач.    49.56    26.10           6.88        1.00
          ст. откл.    18.28     4.95          12.04        0.08
                Mин    18.00     9.01           0.00        0.86
                 Q1    34.00    22.98           0.00        0.86
            Mедиана    50.00    25.87           0.00        1.04
                 Q3    66.00    29.48          10.50        1.05
               Mакс    80.00    39.44          40.00        1.06
                MAD    23.72     4.75           0.00        0.01
                IQR    32.00     6.49          10.25        0.19
                 CV     0.37     0.19           1.75        0.08
         асимметрия    -0.04    -0.02           1.53       -1.03
      SE.асимметрия     0.11     0.11           0.11        0.11
            эксцесс    -1.25     0.09           0.85       -0.92
         Цифр. корр   475.00   475.00         468.00      489.00
         Проц. корр    97.14    97.14          95.71      100.00

Переменные: gender = M  
Кол-во: 489  

                         age      BMI   cigs.per.day   samp.wgts
------------------- -------- -------- -------------- -----------
        сред. знач.    49.58    25.31           6.72        1.00
          ст. откл.    18.34     3.98          11.83        0.08
                Mин    18.00     8.83           0.00        0.86
                 Q1    34.00    22.52           0.00        0.86
            Mедиана    49.50    25.14           0.00        1.04
                 Q3    66.00    27.96          11.00        1.05
               Mакс    80.00    36.76          40.00        1.06
                MAD    24.46     4.02           0.00        0.01
                IQR    32.00     5.44          11.00        0.19
                 CV     0.37     0.16           1.76        0.08
         асимметрия    -0.04    -0.04           1.54       -1.03
      SE.асимметрия     0.11     0.11           0.11        0.11
            эксцесс    -1.27     0.17           0.92       -0.92
         Цифр. корр   478.00   477.00         475.00      489.00
         Проц. корр    97.75    97.55          97.14      100.00

> tobacco$disease <- factor(tobacco$disease)

> stby(tobacco$disease, list(tobacco$smoker, tobacco$gender), freq)
Частота  
tobacco$disease  
Тип: склейка  
Переменные: smoker = Yes, gender = F  

                        Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
--------------------- ------- --------- --------------- --------- --------------------
               Cancer      10     16.39           16.39      6.80                 6.80
          Cholesterol       6      9.84           26.23      4.08                10.88
             Diabetes       3      4.92           31.15      2.04                12.93
            Digestive       2      3.28           34.43      1.36                14.29
              Hearing       2      3.28           37.70      1.36                15.65
                Heart       9     14.75           52.46      6.12                21.77
         Hypertension       8     13.11           65.57      5.44                27.21
          Hypotension       4      6.56           72.13      2.72                29.93
      Musculoskeletal       3      4.92           77.05      2.04                31.97
         Neurological       3      4.92           81.97      2.04                34.01
                Other       1      1.64           83.61      0.68                34.69
            Pulmonary       8     13.11           96.72      5.44                40.14
               Vision       2      3.28          100.00      1.36                41.50
                 <NA>      86                               58.50               100.00
                сумма     147    100.00          100.00    100.00               100.00

Переменные: smoker = No, gender = F  

                        Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
--------------------- ------- --------- --------------- --------- --------------------
               Cancer       6     12.50           12.50      1.75                 1.75
          Cholesterol       4      8.33           20.83      1.17                 2.92
             Diabetes       5     10.42           31.25      1.46                 4.39
            Digestive       3      6.25           37.50      0.88                 5.26
              Hearing       3      6.25           43.75      0.88                 6.14
                Heart       0      0.00           43.75      0.00                 6.14
         Hypertension      10     20.83           64.58      2.92                 9.06
          Hypotension       3      6.25           70.83      0.88                 9.94
      Musculoskeletal       5     10.42           81.25      1.46                11.40
         Neurological       4      8.33           89.58      1.17                12.57
                Other       0      0.00           89.58      0.00                12.57
            Pulmonary       1      2.08           91.67      0.29                12.87
               Vision       4      8.33          100.00      1.17                14.04
                 <NA>     294                               85.96               100.00
                сумма     342    100.00          100.00    100.00               100.00

Переменные: smoker = Yes, gender = M  

                        Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
--------------------- ------- --------- --------------- --------- --------------------
               Cancer      12     19.05           19.05      8.39                 8.39
          Cholesterol       6      9.52           28.57      4.20                12.59
             Diabetes       1      1.59           30.16      0.70                13.29
            Digestive       4      6.35           36.51      2.80                16.08
              Hearing       4      6.35           42.86      2.80                18.88
                Heart       6      9.52           52.38      4.20                23.08
         Hypertension      10     15.87           68.25      6.99                30.07
          Hypotension       1      1.59           69.84      0.70                30.77
      Musculoskeletal       4      6.35           76.19      2.80                33.57
         Neurological       2      3.17           79.37      1.40                34.97
                Other       0      0.00           79.37      0.00                34.97
            Pulmonary      10     15.87           95.24      6.99                41.96
               Vision       3      4.76          100.00      2.10                44.06
                 <NA>      80                               55.94               100.00
                сумма     143    100.00          100.00    100.00               100.00

Переменные: smoker = No, gender = M  

                        Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
--------------------- ------- --------- --------------- --------- --------------------
               Cancer       6     12.77           12.77      1.73                 1.73
          Cholesterol       5     10.64           23.40      1.45                 3.18
             Diabetes       4      8.51           31.91      1.16                 4.34
            Digestive       3      6.38           38.30      0.87                 5.20
              Hearing       5     10.64           48.94      1.45                 6.65
                Heart       5     10.64           59.57      1.45                 8.09
         Hypertension       7     14.89           74.47      2.02                10.12
          Hypotension       3      6.38           80.85      0.87                10.98
      Musculoskeletal       6     12.77           93.62      1.73                12.72
         Neurological       1      2.13           95.74      0.29                13.01
                Other       1      2.13           97.87      0.29                13.29
            Pulmonary       1      2.13          100.00      0.29                13.58
               Vision       0      0.00          100.00      0.00                13.58
                 <NA>     299                               86.42               100.00
                сумма     346    100.00          100.00    100.00               100.00

# -----------------  with + by
> wb1 <- with(tobacco, stby(data = diseased, INDICES = smoker, FUN = freq)) 

> view(wb1, method = "pander", caption = "with + by")
Частота  
tobacco$diseased  
Тип: склейка  
Переменные: smoker = Yes  

              Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- ------- --------- --------------- --------- --------------------
        Yes     125     41.95           41.95     41.95                41.95
         No     173     58.05          100.00     58.05               100.00
       <NA>       0                                0.00               100.00
      сумма     298    100.00          100.00    100.00               100.00

Table: with + by

Переменные: smoker = No  

              Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- ------- --------- --------------- --------- --------------------
        Yes      99     14.10           14.10     14.10                14.10
         No     603     85.90          100.00     85.90               100.00
       <NA>       0                                0.00               100.00
      сумма     702    100.00          100.00    100.00               100.00

Table: with + by

> view(wb1, method = "browser", footnote = "with + by", file = "14.html")
Output file written
Output file appended

> view(wb1, headings = FALSE, footnote = "no headings", file = "15.html")
Output file written
Output file appended

> view(wb1, headings = FALSE, footnote = "no headings", method = "pander") 
Переменные: smoker = Yes  

              Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- ------- --------- --------------- --------- --------------------
        Yes     125     41.95           41.95     41.95                41.95
         No     173     58.05          100.00     58.05               100.00
       <NA>       0                                0.00               100.00
      сумма     298    100.00          100.00    100.00               100.00

Переменные: smoker = No  

              Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- ------- --------- --------------- --------- --------------------
        Yes      99     14.10           14.10     14.10                14.10
         No     603     85.90          100.00     85.90               100.00
       <NA>       0                                0.00               100.00
      сумма     702    100.00          100.00    100.00               100.00

> wb2 <- with(tobacco, stby(data = BMI, INDICES = gender, FUN = descr)) 

> view(wb2, method = "pander")
Кол-венный показатель распределения  
BMI группа gender  
Верт. таблица: tobacco  
Кол-во: 489  

                           F        M
------------------- -------- --------
        сред. знач.    26.10    25.31
          ст. откл.     4.95     3.98
                Mин     9.01     8.83
                 Q1    22.98    22.52
            Mедиана    25.87    25.14
                 Q3    29.48    27.96
               Mакс    39.44    36.76
                MAD     4.75     4.02
                IQR     6.49     5.44
                 CV     0.19     0.16
         асимметрия    -0.02    -0.04
      SE.асимметрия     0.11     0.11
            эксцесс     0.09     0.17
         Цифр. корр   475.00   477.00
         Проц. корр    97.14    97.55

> view(wb2, method = "browser", footnote = "with + by", file = "16.html")
Output file written

> view(with(tobacco, stby(data = BMI, INDICES = gender, FUN = descr, stats = "fivenum")), method = "browser", footnote = "with + by fivenum", file = "17.html")
Output file written

> (b5 <- with(tobacco, stby(BMI, age.gr, descr, stats = c("mean", "sd", "min", "med", "max"))))
Кол-венный показатель распределения  
BMI группа age.gr  
Верт. таблица: tobacco  
Кол-во: 258  

                    18-34   35-50   51-70    71 +
----------------- ------- ------- ------- -------
      сред. знач.   23.84   25.11   26.91   27.45
        ст. откл.    4.23    4.34    4.26    4.37
              Mин    8.83   10.35    9.01   16.36
          Mедиана   24.04   25.11   26.77   27.52
             Mакс   34.84   39.44   39.21   38.37

> print(b5, "pander", style = "rmarkdown") 
### Кол-венный показатель распределения  
#### BMI группа age.gr  
**Верт. таблица:** tobacco  
**Кол-во:** 258  

|          &nbsp; | 18-34 | 35-50 | 51-70 |  71 + |
|----------------:|------:|------:|------:|------:|
| **сред. знач.** | 23.84 | 25.11 | 26.91 | 27.45 |
|   **ст. откл.** |  4.23 |  4.34 |  4.26 |  4.37 |
|         **Mин** |  8.83 | 10.35 |  9.01 | 16.36 |
|     **Mедиана** | 24.04 | 25.11 | 26.77 | 27.52 |
|        **Mакс** | 34.84 | 39.44 | 39.21 | 38.37 |

> b6 <- with(tobacco, stby(BMI, age.gr, descr, stats = c("mean", "sd", "min", "max"), transpose = TRUE))

> view(b6, "pander") 
Кол-венный показатель распределения  
BMI группа age.gr  
Верт. таблица: tobacco  
Кол-во: 258  

              сред. знач.   ст. откл.     Mин    Mакс
----------- ------------- ----------- ------- -------
      18-34         23.84        4.23    8.83   34.84
      35-50         25.11        4.34   10.35   39.44
      51-70         26.91        4.26    9.01   39.21
       71 +         27.45        4.37   16.36   38.37

> view(b6, method = "browser", footnote = "4 stats", file = "18.html")
Output file written

> with(tobacco, view(stby(data = diseased, INDICES = smoker, FUN = freq, totals = F), method = "browser", footnote = "with + by", file = "19.html"))
Output file written
Output file appended

> view(with(tobacco, stby(data = BMI, INDICES = gender, FUN = descr)), method = "browser", file = "20.html")
Output file written

> with(tobacco, view(stby(data = BMI, INDICES = gender, FUN = descr), method = "pander"))
Кол-венный показатель распределения  
BMI группа gender  
Верт. таблица: tobacco  
Кол-во: 489  

                           F        M
------------------- -------- --------
        сред. знач.    26.10    25.31
          ст. откл.     4.95     3.98
                Mин     9.01     8.83
                 Q1    22.98    22.52
            Mедиана    25.87    25.14
                 Q3    29.48    27.96
               Mакс    39.44    36.76
                MAD     4.75     4.02
                IQR     6.49     5.44
                 CV     0.19     0.16
         асимметрия    -0.02    -0.04
      SE.асимметрия     0.11     0.11
            эксцесс     0.09     0.17
         Цифр. корр   475.00   477.00
         Проц. корр    97.14    97.55

# -----------------  Ouverture dans viewer
> view(b8, method = "viewer")
Non-numerical variable(s) ignored: Species
Output file written

# -----------------  by + weights
> with(tobacco, stby(smoker, gender, freq, weights = samp.wgts))
Взвешенная частота  
tobacco$smoker  
Тип: склейка  
Вес: samp.wgts  
Переменные: gender = F  

               Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- -------- --------- --------------- --------- --------------------
        Yes   147.39     30.14           30.14     30.14                30.14
         No   341.54     69.86          100.00     69.86               100.00
       <NA>     0.00                                0.00               100.00
      сумма   488.92    100.00          100.00    100.00               100.00

Переменные: gender = M  

               Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- -------- --------- --------------- --------- --------------------
        Yes   142.86     29.22           29.22     29.22                29.22
         No   346.05     70.78          100.00     70.78               100.00
       <NA>     0.00                                0.00               100.00
      сумма   488.92    100.00          100.00    100.00               100.00

> with(tobacco, stby(list(x=gender, y=smoker), age.gr, ctable, weights = samp.wgts))
Кросс-табуляция, пропорции по рядам  
gender * smoker  
Верт. таблица: tobacco  
Переменные: age.gr = 18-34  

-------- -------- -------------- --------------- ----------------
           smoker            Yes              No            сумма
  gender                                                         
       F            29.3 (27.6%)    76.7 (72.4%)   106.0 (100.0%)
       M            32.7 (29.2%)    79.3 (70.8%)   112.0 (100.0%)
    <NA>             1.7 (40.0%)     2.6 (60.0%)     4.3 (100.0%)
   сумма            63.7 (28.7%)   158.5 (71.3%)   222.2 (100.0%)
-------- -------- -------------- --------------- ----------------

Переменные: age.gr = 35-50  

-------- -------- -------------- --------------- ----------------
           smoker            Yes              No            сумма
  gender                                                         
       F            40.7 (33.1%)    82.5 (66.9%)   123.2 (100.0%)
       M            32.4 (26.3%)    90.8 (73.7%)   123.2 (100.0%)
    <NA>             2.1 (40.0%)     3.1 (60.0%)     5.2 (100.0%)
   сумма            75.2 (29.9%)   176.5 (70.1%)   251.6 (100.0%)
-------- -------- -------------- --------------- ----------------

Переменные: age.gr = 51-70  

-------- -------- --------------- --------------- ----------------
           smoker             Yes              No            сумма
  gender                                                          
       F             50.4 (30.6%)   114.4 (69.4%)   164.8 (100.0%)
       M             50.4 (31.8%)   108.1 (68.2%)   158.5 (100.0%)
    <NA>              3.1 (33.3%)     6.3 (66.7%)     9.4 (100.0%)
   сумма            103.9 (31.2%)   228.8 (68.8%)   332.7 (100.0%)
-------- -------- --------------- --------------- ----------------

Переменные: age.gr = 71 +  

-------- -------- -------------- --------------- ----------------
           smoker            Yes              No            сумма
  gender                                                         
       F            22.3 (27.3%)    59.5 (72.7%)    81.8 (100.0%)
       M            24.4 (29.1%)    59.5 (70.9%)    83.9 (100.0%)
    <NA>             1.1 (33.3%)     2.1 (66.7%)     3.2 (100.0%)
   сумма            47.8 (28.3%)   121.1 (71.7%)   168.9 (100.0%)
-------- -------- -------------- --------------- ----------------

> tobacco %>% group_by(gender) %>% freq(smoker, weights = samp.wgts)
Взвешенная частота  
tobacco$smoker  
Тип: склейка  
Вес: samp.wgts  
Переменные: gender = F  

               Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- -------- --------- --------------- --------- --------------------
        Yes   147.39     30.14           30.14     30.14                30.14
         No   341.54     69.86          100.00     69.86               100.00
       <NA>     0.00                                0.00               100.00
      сумма   488.92    100.00          100.00    100.00               100.00

Переменные: gender = M  

               Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- -------- --------- --------------- --------- --------------------
        Yes   142.86     29.22           29.22     29.22                29.22
         No   346.05     70.78          100.00     70.78               100.00
       <NA>     0.00                                0.00               100.00
      сумма   488.92    100.00          100.00    100.00               100.00

Переменные: gender = NA  

              Част.   % корр.   % корр. сумм.   % сумма   % совокупной суммы
----------- ------- --------- --------------- --------- --------------------
        Yes    8.02     36.20           36.20     36.20                36.20
         No   14.14     63.80          100.00     63.80               100.00
       <NA>    0.00                                0.00               100.00
      сумма   22.16    100.00          100.00    100.00               100.00

> st_options("reset")
summarytools options have been reset

> detach("package:summarytools")

> detach("package:dplyr")
