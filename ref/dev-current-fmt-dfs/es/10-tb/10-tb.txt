
# -----------------  tb.R ------------------------------------
> suppressPackageStartupMessages(library(summarytools))

> suppressPackageStartupMessages(library(dplyr))

> suppressPackageStartupMessages(library(magrittr))

> options(tibble.print_max = Inf)

# ----------------- set.seed(765543543)
# ----------------- na_pos <- sample(1:1000, size = 25, replace = FALSE)
> 
> na_pos <- c(804L, 800L, 290L, 532L, 243L, 336L, 207L, 805L, 318L, 78L, 
>            285L, 931L, 298L, 204L, 113L, 3 .... [TRUNCATED] 

# ----------------- na_pos <- c(850L, 203L, 962L, 246L, 759L, 601L, 555L, 112L, 275L, 683L, 
# -----------------             684L, 638L, 83L, 331L, 841L, 367L, 40L, 872L, 937L, 265L, 519L, 
# -----------------             197L, 237L, 370L, 648L)       .... [TRUNCATED] 

> tobacco$smoker[na_pos] <- NA_character_

# -----------------  Normal freq table
> (fr1 <-  tobacco %$% freq(gender))
Frecuencias  
tobacco$gender  
Tipo: Factor  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
          F     489      50.00           50.00     48.90          48.90
          M     489      50.00          100.00     48.90          97.80
       <NA>      22                                 2.20         100.00
      Total    1000     100.00          100.00    100.00         100.00

> fr1 %>% tb()
# A tibble: 3 x 6
  gender  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
1 F        489        50            50   48.9         48.9
2 M        489        50           100   48.9         97.8
3 <NA>      22        NA            NA    2.20       100  

> fr1 %>% tb(2) # aucun effet attendu
# A tibble: 3 x 6
  gender  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
1 F        489        50            50   48.9         48.9
2 M        489        50           100   48.9         97.8
3 <NA>      22        NA            NA    2.20       100  

> fr1 %>% tb(3) # aucun effet attendu
# A tibble: 3 x 6
  gender  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
1 F        489        50            50   48.9         48.9
2 M        489        50           100   48.9         97.8
3 <NA>      22        NA            NA    2.20       100  

> fr1 %>% tb(na.rm = TRUE)
# A tibble: 2 x 4
  gender  freq   pct pct_cum
  <fct>  <dbl> <dbl>   <dbl>
1 F        489    50      50
2 M        489    50     100

> fr1 %>% tb() %>% select(2,3,5) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
     1000       100       100 

# -----------------  No NA's
> (fr2 <- tobacco %$% freq(gender, report.nas = FALSE))
Frecuencias  
tobacco$gender  
Tipo: Factor  

              Frec.        %   % Acu.
----------- ------- -------- --------
          F     489    50.00    50.00
          M     489    50.00   100.00
      Total     978   100.00   100.00

> fr2 %>% tb(na.rm = TRUE)
# A tibble: 2 x 4
  gender  freq   pct pct_cum
  <fct>  <dbl> <dbl>   <dbl>
1 F        489    50      50
2 M        489    50     100

> fr2 %>% tb() %>% select(2,3) %>% colSums(na.rm = T)
freq  pct 
 978  100 

# -----------------  with sampling weights
> (fr3 <- tobacco %$% freq(gender, weights = samp.wgts))
Frecuencías ponderadas  
tobacco$gender  
Tipo: Factor  
Pesos: samp.wgts  

                Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- --------- ---------- --------------- --------- --------------
          F    488.92      50.00           50.00     48.89          48.89
          M    488.92      50.00          100.00     48.89          97.78
       <NA>     22.16                                 2.22         100.00
      Total   1000.00     100.00          100.00    100.00         100.00

> fr3 %>% tb()
# A tibble: 3 x 6
  gender  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
1 F      489.       50.0          50.0   48.9         48.9
2 M      489.       50.0         100     48.9         97.8
3 <NA>    22.2      NA            NA      2.22       100  

> fr3 %>% tb(na.rm = TRUE)
# A tibble: 2 x 4
  gender  freq   pct pct_cum
  <fct>  <dbl> <dbl>   <dbl>
1 F       489.  50.0    50.0
2 M       489.  50.0   100  

> fr3 %>% tb() %>% select(2,3,5) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
     1000       100       100 

# -----------------  with sampling weights, no cumul
> (fr4 <- tobacco %$% freq(gender, weights = samp.wgts, cumul = FALSE))
Frecuencías ponderadas  
tobacco$gender  
Tipo: Factor  
Pesos: samp.wgts  

                Frec.   % Válido   % Total
----------- --------- ---------- ---------
          F    488.92      50.00     48.89
          M    488.92      50.00     48.89
       <NA>     22.16                 2.22
      Total   1000.00     100.00    100.00

> fr4 %>% tb()
# A tibble: 3 x 4
  gender  freq pct_valid pct_tot
  <fct>  <dbl>     <dbl>   <dbl>
1 F      489.       50.0   48.9 
2 M      489.       50.0   48.9 
3 <NA>    22.2      NA      2.22

> fr4 %>% tb() %>% select(2,3,4) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
     1000       100       100 

# -----------------  with sampling weights, no cumul, no missing
> (fr5 <- tobacco %$% freq(gender, weights = samp.wgts, cumul = FALSE, report.nas = FALSE))
Frecuencías ponderadas  
tobacco$gender  
Tipo: Factor  
Pesos: samp.wgts  

               Frec.        %
----------- -------- --------
          F   488.92    50.00
          M   488.92    50.00
      Total   977.84   100.00

> fr5 %>% tb()
# A tibble: 2 x 3
  gender  freq   pct
  <fct>  <dbl> <dbl>
1 F       489.  50.0
2 M       489.  50.0

> fr5 %>% tb() %>% select(2,3) %>% colSums(na.rm = T)
    freq      pct 
977.8401 100.0000 

# -----------------  Freq with grouped results
> (fgr1 <- stby(tobacco$smoker, INDICES = tobacco$gender, FUN = freq))
Frecuencias  
tobacco$smoker  
Tipo: Factor  
Subgrupo: gender = F  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes     146      30.80           30.80     29.86          29.86
         No     328      69.20          100.00     67.08          96.93
       <NA>      15                                 3.07         100.00
      Total     489     100.00          100.00    100.00         100.00

Subgrupo: gender = M  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes     138      28.81           28.81     28.22          28.22
         No     341      71.19          100.00     69.73          97.96
       <NA>      10                                 2.04         100.00
      Total     489     100.00          100.00    100.00         100.00

> fgr1 %>% tb()
# A tibble: 6 x 7
  gender smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
  <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
1 F      Yes      146      15.4          15.4   14.9         14.9
2 F      No       328      34.6          50     33.5         48.5
3 F      <NA>      15      NA            50      1.53        50  
4 M      Yes      138      14.4          64.4   14.1         64.1
5 M      No       341      35.6         100     34.9         99.0
6 M      <NA>      10      NA           100      1.02       100  

> fgr1 %>% tb(2)
# A tibble: 6 x 7
  gender smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
  <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
1 F      Yes      146      15.4          15.4   14.9         14.9
2 M      Yes      138      14.4          29.8   14.1         29.0
3 F      No       328      34.6          64.4   33.5         62.6
4 M      No       341      35.6         100     34.9         97.4
5 F      <NA>      15      NA           100      1.53        99.0
6 M      <NA>      10      NA           100      1.02       100  

> fgr1 %>% tb(3)
# A tibble: 6 x 7
  smoker gender  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
  <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
1 Yes    F        146      15.4          15.4   14.9         14.9
2 Yes    M        138      14.4          29.8   14.1         29.0
3 No     F        328      34.6          64.4   33.5         62.6
4 No     M        341      35.6         100     34.9         97.4
5 <NA>   F         15      NA           100      1.53        99.0
6 <NA>   M         10      NA           100      1.02       100  

> fgr1 %>% tb() %>% select(3,4,6)
# A tibble: 6 x 3
   freq pct_valid pct_tot
  <dbl>     <dbl>   <dbl>
1   146      15.4   14.9 
2   328      34.6   33.5 
3    15      NA      1.53
4   138      14.4   14.1 
5   341      35.6   34.9 
6    10      NA      1.02

> fgr1 %>% tb() %>% select(3,4,6) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
      978       100       100 

# -----------------  Freq with grouped results, no cumul
> (fgr2 <- stby(tobacco$smoker, INDICES = tobacco$gender, FUN = freq, cumul = FALSE))
Frecuencias  
tobacco$smoker  
Tipo: Factor  
Subgrupo: gender = F  

              Frec.   % Válido   % Total
----------- ------- ---------- ---------
        Yes     146      30.80     29.86
         No     328      69.20     67.08
       <NA>      15                 3.07
      Total     489     100.00    100.00

Subgrupo: gender = M  

              Frec.   % Válido   % Total
----------- ------- ---------- ---------
        Yes     138      28.81     28.22
         No     341      71.19     69.73
       <NA>      10                 2.04
      Total     489     100.00    100.00

> fgr2 %>% tb()
# A tibble: 6 x 5
  gender smoker  freq pct_valid pct_tot
  <fct>  <fct>  <dbl>     <dbl>   <dbl>
1 F      Yes      146      15.4   14.9 
2 F      No       328      34.6   33.5 
3 F      <NA>      15      NA      1.53
4 M      Yes      138      14.4   14.1 
5 M      No       341      35.6   34.9 
6 M      <NA>      10      NA      1.02

> fgr2 %>% tb(2)
# A tibble: 6 x 5
  gender smoker  freq pct_valid pct_tot
  <fct>  <fct>  <dbl>     <dbl>   <dbl>
1 F      Yes      146      15.4   14.9 
2 M      Yes      138      14.4   14.1 
3 F      No       328      34.6   33.5 
4 M      No       341      35.6   34.9 
5 F      <NA>      15      NA      1.53
6 M      <NA>      10      NA      1.02

> fgr2 %>% tb(3)
# A tibble: 6 x 5
  smoker gender  freq pct_valid pct_tot
  <fct>  <fct>  <dbl>     <dbl>   <dbl>
1 Yes    F        146      15.4   14.9 
2 Yes    M        138      14.4   14.1 
3 No     F        328      34.6   33.5 
4 No     M        341      35.6   34.9 
5 <NA>   F         15      NA      1.53
6 <NA>   M         10      NA      1.02

> fgr2 %>% tb() %>% select(3,4,5) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
      978       100       100 

> fgr2 %>% tb(2) %>% select(3,4,5) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
      978       100       100 

# -----------------  Freq with grouped results, no cumul, no NA's
> (fgr3 <- stby(tobacco$smoker, INDICES = tobacco$gender, FUN = freq, cumul = FALSE, report.nas = FALSE))
Frecuencias  
tobacco$smoker  
Tipo: Factor  
Subgrupo: gender = F  

              Frec.        %
----------- ------- --------
        Yes     146    30.80
         No     328    69.20
      Total     474   100.00

Subgrupo: gender = M  

              Frec.        %
----------- ------- --------
        Yes     138    28.81
         No     341    71.19
      Total     479   100.00

> fgr3 %>% tb()
# A tibble: 4 x 4
  gender smoker  freq   pct
  <fct>  <fct>  <dbl> <dbl>
1 F      Yes      146  15.4
2 F      No       328  34.6
3 M      Yes      138  14.4
4 M      No       341  35.6

> fgr3 %>% tb(2)
# A tibble: 4 x 4
  gender smoker  freq   pct
  <fct>  <fct>  <dbl> <dbl>
1 F      Yes      146  15.4
2 M      Yes      138  14.4
3 F      No       328  34.6
4 M      No       341  35.6

> fgr3 %>% tb(3)
# A tibble: 4 x 4
  smoker gender  freq   pct
  <fct>  <fct>  <dbl> <dbl>
1 Yes    F        146  15.4
2 Yes    M        138  14.4
3 No     F        328  34.6
4 No     M        341  35.6

> fgr3 %>% tb() %>% select(3,4) %>% colSums(na.rm = T)
freq  pct 
 953  100 

# -----------------  Freq with grouped results
> (fgr4 <- stby(tobacco$smoker, INDICES = tobacco$age.gr, FUN = freq))
Frecuencias  
tobacco$smoker  
Tipo: Factor  
Subgrupo: age.gr = 18-34  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      73      28.63           28.63     28.29          28.29
         No     182      71.37          100.00     70.54          98.84
       <NA>       3                                 1.16         100.00
      Total     258     100.00          100.00    100.00         100.00

Subgrupo: age.gr = 35-50  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      72      30.90           30.90     29.88          29.88
         No     161      69.10          100.00     66.80          96.68
       <NA>       8                                 3.32         100.00
      Total     241     100.00          100.00    100.00         100.00

Subgrupo: age.gr = 51-70  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      97      31.60           31.60     30.60          30.60
         No     210      68.40          100.00     66.25          96.85
       <NA>      10                                 3.15         100.00
      Total     317     100.00          100.00    100.00         100.00

Subgrupo: age.gr = 71 +  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      42      27.10           27.10     26.42          26.42
         No     113      72.90          100.00     71.07          97.48
       <NA>       4                                 2.52         100.00
      Total     159     100.00          100.00    100.00         100.00

> fgr4 %>% tb()
# A tibble: 12 x 7
   age.gr smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
   <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
 1 18-34  Yes       73      7.16          7.16   7.07         7.07
 2 18-34  No       182     17.8          25     17.6         24.7 
 3 18-34  <NA>       3     NA            25      0.291       25   
 4 35-50  Yes       72      7.73         32.7    7.47        32.5 
 5 35-50  No       161     17.3          50     16.7         49.2 
 6 35-50  <NA>       8     NA            50      0.830       50   
 7 51-70  Yes       97      7.90         57.9    7.65        57.6 
 8 51-70  No       210     17.1          75     16.6         74.2 
 9 51-70  <NA>      10     NA            75      0.789       75   
10 71 +   Yes       42      6.77         81.8    6.60        81.6 
11 71 +   No       113     18.2         100     17.8         99.4 
12 71 +   <NA>       4     NA           100      0.629      100   

> fgr4 %>% tb(2)
# A tibble: 12 x 7
   age.gr smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
   <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
 1 18-34  Yes       73      7.16          7.16   7.07         7.07
 2 35-50  Yes       72      7.73         14.9    7.47        14.5 
 3 51-70  Yes       97      7.90         22.8    7.65        22.2 
 4 71 +   Yes       42      6.77         29.6    6.60        28.8 
 5 18-34  No       182     17.8          47.4   17.6         46.4 
 6 35-50  No       161     17.3          64.7   16.7         63.1 
 7 51-70  No       210     17.1          81.8   16.6         79.7 
 8 71 +   No       113     18.2         100     17.8         97.5 
 9 18-34  <NA>       3     NA           100      0.291       97.8 
10 35-50  <NA>       8     NA           100      0.830       98.6 
11 51-70  <NA>      10     NA           100      0.789       99.4 
12 71 +   <NA>       4     NA           100      0.629      100   

> fgr4 %>% tb() %>% select(3,4,6) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
      975       100       100 

> fgr4 %>% tb(2) %>% select(3,4,6) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
      975       100       100 

# -----------------  Freq with grouped results, freq sorting (+)
> (fgr5 <- stby(tobacco$smoker, INDICES = tobacco$age.gr, FUN = freq, order = "freq"))
Frecuencias  
tobacco$smoker  
Tipo: Factor  
Subgrupo: age.gr = 18-34  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
         No     182      71.37           71.37     70.54          70.54
        Yes      73      28.63          100.00     28.29          98.84
       <NA>       3                                 1.16         100.00
      Total     258     100.00          100.00    100.00         100.00

Subgrupo: age.gr = 35-50  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
         No     161      69.10           69.10     66.80          66.80
        Yes      72      30.90          100.00     29.88          96.68
       <NA>       8                                 3.32         100.00
      Total     241     100.00          100.00    100.00         100.00

Subgrupo: age.gr = 51-70  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
         No     210      68.40           68.40     66.25          66.25
        Yes      97      31.60          100.00     30.60          96.85
       <NA>      10                                 3.15         100.00
      Total     317     100.00          100.00    100.00         100.00

Subgrupo: age.gr = 71 +  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
         No     113      72.90           72.90     71.07          71.07
        Yes      42      27.10          100.00     26.42          97.48
       <NA>       4                                 2.52         100.00
      Total     159     100.00          100.00    100.00         100.00

> fgr5 %>% tb()
# A tibble: 12 x 7
   age.gr smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
   <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
 1 18-34  No       182     17.8           17.8  17.6          17.6
 2 18-34  Yes       73      7.16          25     7.07         24.7
 3 18-34  <NA>       3     NA             25     0.291        25  
 4 35-50  No       161     17.3           42.3  16.7          41.7
 5 35-50  Yes       72      7.73          50     7.47         49.2
 6 35-50  <NA>       8     NA             50     0.830        50  
 7 51-70  No       210     17.1           67.1  16.6          66.6
 8 51-70  Yes       97      7.90          75     7.65         74.2
 9 51-70  <NA>      10     NA             75     0.789        75  
10 71 +   No       113     18.2           93.2  17.8          92.8
11 71 +   Yes       42      6.77         100     6.60         99.4
12 71 +   <NA>       4     NA            100     0.629       100  

> fgr5 %>% tb(2)
# A tibble: 12 x 7
   age.gr smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
   <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
 1 18-34  No       182     17.8           17.8  17.6          17.6
 2 35-50  No       161     17.3           35.1  16.7          34.3
 3 51-70  No       210     17.1           52.2  16.6          50.9
 4 71 +   No       113     18.2           70.4  17.8          68.7
 5 18-34  Yes       73      7.16          77.6   7.07         75.7
 6 35-50  Yes       72      7.73          85.3   7.47         83.2
 7 51-70  Yes       97      7.90          93.2   7.65         90.9
 8 71 +   Yes       42      6.77         100     6.60         97.5
 9 18-34  <NA>       3     NA            100     0.291        97.8
10 35-50  <NA>       8     NA            100     0.830        98.6
11 51-70  <NA>      10     NA            100     0.789        99.4
12 71 +   <NA>       4     NA            100     0.629       100  

> fgr5 %>% tb(3)
# A tibble: 12 x 7
   smoker age.gr  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
   <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
 1 No     18-34    182     17.8           17.8  17.6          17.6
 2 No     35-50    161     17.3           35.1  16.7          34.3
 3 No     51-70    210     17.1           52.2  16.6          50.9
 4 No     71 +     113     18.2           70.4  17.8          68.7
 5 Yes    18-34     73      7.16          77.6   7.07         75.7
 6 Yes    35-50     72      7.73          85.3   7.47         83.2
 7 Yes    51-70     97      7.90          93.2   7.65         90.9
 8 Yes    71 +      42      6.77         100     6.60         97.5
 9 <NA>   18-34      3     NA            100     0.291        97.8
10 <NA>   35-50      8     NA            100     0.830        98.6
11 <NA>   51-70     10     NA            100     0.789        99.4
12 <NA>   71 +       4     NA            100     0.629       100  

> fgr5 %>% tb() %>% select(3,4,6) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
      975       100       100 

> fgr5 %>% tb(2) %>% select(3,4,6) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
      975       100       100 

# -----------------  Freq with grouped results, freq sorting (-)
> (fgr6 <- stby(tobacco$smoker, INDICES = tobacco$age.gr, FUN = freq, order = "freq-"))
Frecuencias  
tobacco$smoker  
Tipo: Factor  
Subgrupo: age.gr = 18-34  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      73      28.63           28.63     28.29          28.29
         No     182      71.37          100.00     70.54          98.84
       <NA>       3                                 1.16         100.00
      Total     258     100.00          100.00    100.00         100.00

Subgrupo: age.gr = 35-50  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      72      30.90           30.90     29.88          29.88
         No     161      69.10          100.00     66.80          96.68
       <NA>       8                                 3.32         100.00
      Total     241     100.00          100.00    100.00         100.00

Subgrupo: age.gr = 51-70  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      97      31.60           31.60     30.60          30.60
         No     210      68.40          100.00     66.25          96.85
       <NA>      10                                 3.15         100.00
      Total     317     100.00          100.00    100.00         100.00

Subgrupo: age.gr = 71 +  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      42      27.10           27.10     26.42          26.42
         No     113      72.90          100.00     71.07          97.48
       <NA>       4                                 2.52         100.00
      Total     159     100.00          100.00    100.00         100.00

> fgr6 %>% tb()
# A tibble: 12 x 7
   age.gr smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
   <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
 1 18-34  Yes       73      7.16          7.16   7.07         7.07
 2 18-34  No       182     17.8          25     17.6         24.7 
 3 18-34  <NA>       3     NA            25      0.291       25   
 4 35-50  Yes       72      7.73         32.7    7.47        32.5 
 5 35-50  No       161     17.3          50     16.7         49.2 
 6 35-50  <NA>       8     NA            50      0.830       50   
 7 51-70  Yes       97      7.90         57.9    7.65        57.6 
 8 51-70  No       210     17.1          75     16.6         74.2 
 9 51-70  <NA>      10     NA            75      0.789       75   
10 71 +   Yes       42      6.77         81.8    6.60        81.6 
11 71 +   No       113     18.2         100     17.8         99.4 
12 71 +   <NA>       4     NA           100      0.629      100   

> fgr6 %>% tb(2)
# A tibble: 12 x 7
   age.gr smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
   <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
 1 18-34  Yes       73      7.16          7.16   7.07         7.07
 2 35-50  Yes       72      7.73         14.9    7.47        14.5 
 3 51-70  Yes       97      7.90         22.8    7.65        22.2 
 4 71 +   Yes       42      6.77         29.6    6.60        28.8 
 5 18-34  No       182     17.8          47.4   17.6         46.4 
 6 35-50  No       161     17.3          64.7   16.7         63.1 
 7 51-70  No       210     17.1          81.8   16.6         79.7 
 8 71 +   No       113     18.2         100     17.8         97.5 
 9 18-34  <NA>       3     NA           100      0.291       97.8 
10 35-50  <NA>       8     NA           100      0.830       98.6 
11 51-70  <NA>      10     NA           100      0.789       99.4 
12 71 +   <NA>       4     NA           100      0.629      100   

> fgr6 %>% tb() %>% select(3,4,6) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
      975       100       100 

> fgr6 %>% tb(2) %>% select(3,4,6) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
      975       100       100 

# -----------------  Freq with grouped results, 2 grouping vars
> (fgr7 <- stby(tobacco$smoker, INDICES = list(tobacco$gender, tobacco$age.gr), FUN = freq))
Frecuencias  
tobacco$smoker  
Tipo: Factor  
Subgrupo: gender = F, age.gr = 18-34  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      34      28.10           28.10     27.64          27.64
         No      87      71.90          100.00     70.73          98.37
       <NA>       2                                 1.63         100.00
      Total     123     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = 18-34  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      37      28.68           28.68     28.46          28.46
         No      92      71.32          100.00     70.77          99.23
       <NA>       1                                 0.77         100.00
      Total     130     100.00          100.00    100.00         100.00

Subgrupo: gender = F, age.gr = 35-50  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      39      34.82           34.82     33.05          33.05
         No      73      65.18          100.00     61.86          94.92
       <NA>       6                                 5.08         100.00
      Total     118     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = 35-50  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      31      26.72           26.72     26.27          26.27
         No      85      73.28          100.00     72.03          98.31
       <NA>       2                                 1.69         100.00
      Total     118     100.00          100.00    100.00         100.00

Subgrupo: gender = F, age.gr = 51-70  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      48      31.58           31.58     30.57          30.57
         No     104      68.42          100.00     66.24          96.82
       <NA>       5                                 3.18         100.00
      Total     157     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = 51-70  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      46      31.51           31.51     30.46          30.46
         No     100      68.49          100.00     66.23          96.69
       <NA>       5                                 3.31         100.00
      Total     151     100.00          100.00    100.00         100.00

Subgrupo: gender = F, age.gr = 71 +  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      20      26.67           26.67     25.97          25.97
         No      55      73.33          100.00     71.43          97.40
       <NA>       2                                 2.60         100.00
      Total      77     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = 71 +  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      21      27.27           27.27     26.58          26.58
         No      56      72.73          100.00     70.89          97.47
       <NA>       2                                 2.53         100.00
      Total      79     100.00          100.00    100.00         100.00

> fgr7 %>% tb()
# A tibble: 24 x 8
   gender age.gr smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
   <fct>  <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
 1 F      18-34  Yes       34      3.51          3.51  3.46          3.46
 2 F      18-34  No        87      8.99         12.5   8.84         12.3 
 3 F      18-34  <NA>       2     NA            12.5   0.203        12.5 
 4 F      35-50  Yes       39      4.35         16.9   4.13         16.6 
 5 F      35-50  No        73      8.15         25     7.73         24.4 
 6 F      35-50  <NA>       6     NA            25     0.636        25   
 7 F      51-70  Yes       48      3.95         28.9   3.82         28.8 
 8 F      51-70  No       104      8.55         37.5   8.28         37.1 
 9 F      51-70  <NA>       5     NA            37.5   0.398        37.5 
10 F      71 +   Yes       20      3.33         40.8   3.25         40.7 
11 F      71 +   No        55      9.17         50     8.93         49.7 
12 F      71 +   <NA>       2     NA            50     0.325        50   
13 M      18-34  Yes       37      3.59         53.6   3.56         53.6 
14 M      18-34  No        92      8.91         62.5   8.85         62.4 
15 M      18-34  <NA>       1     NA            62.5   0.0962       62.5 
16 M      35-50  Yes       31      3.34         65.8   3.28         65.8 
17 M      35-50  No        85      9.16         75     9.00         74.8 
18 M      35-50  <NA>       2     NA            75     0.212        75   
19 M      51-70  Yes       46      3.94         78.9   3.81         78.8 
20 M      51-70  No       100      8.56         87.5   8.28         87.1 
21 M      51-70  <NA>       5     NA            87.5   0.414        87.5 
22 M      71 +   Yes       21      3.41         90.9   3.32         90.8 
23 M      71 +   No        56      9.09        100     8.86         99.7 
24 M      71 +   <NA>       2     NA           100     0.316       100   

> fgr7 %>% tb(2)
# A tibble: 24 x 8
   gender age.gr smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
   <fct>  <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
 1 F      18-34  Yes       34      3.51          3.51  3.46          3.46
 2 F      35-50  Yes       39      4.35          7.87  4.13          7.59
 3 F      51-70  Yes       48      3.95         11.8   3.82         11.4 
 4 F      71 +   Yes       20      3.33         15.1   3.25         14.7 
 5 M      18-34  Yes       37      3.59         18.7   3.56         18.2 
 6 M      35-50  Yes       31      3.34         22.1   3.28         21.5 
 7 M      51-70  Yes       46      3.94         26.0   3.81         25.3 
 8 M      71 +   Yes       21      3.41         29.4   3.32         28.6 
 9 F      18-34  No        87      8.99         38.4   8.84         37.5 
10 F      35-50  No        73      8.15         46.6   7.73         45.2 
11 F      51-70  No       104      8.55         55.1   8.28         53.5 
12 F      71 +   No        55      9.17         64.3   8.93         62.4 
13 M      18-34  No        92      8.91         73.2   8.85         71.3 
14 M      35-50  No        85      9.16         82.3   9.00         80.3 
15 M      51-70  No       100      8.56         90.9   8.28         88.5 
16 M      71 +   No        56      9.09        100     8.86         97.4 
17 F      18-34  <NA>       2     NA           100     0.203        97.6 
18 F      35-50  <NA>       6     NA           100     0.636        98.2 
19 F      51-70  <NA>       5     NA           100     0.398        98.6 
20 F      71 +   <NA>       2     NA           100     0.325        99.0 
21 M      18-34  <NA>       1     NA           100     0.0962       99.1 
22 M      35-50  <NA>       2     NA           100     0.212        99.3 
23 M      51-70  <NA>       5     NA           100     0.414        99.7 
24 M      71 +   <NA>       2     NA           100     0.316       100   

> fgr7 %>% tb() %>% select(4,5,7) %>% colSums(na.rm = T)
     freq pct_valid   pct_tot 
      953       100       100 

# -----------------  Normal descr() results
> (de1 <- descr(examens))
Non-numerical variable(s) ignored: eleve, sexe
Estadísticas descriptivas  
examens  
N: 30  

                     anglais   economie   francais   geographie   histoire   maths
------------------ --------- ---------- ---------- ------------ ---------- -------
             Media     75.96      73.91      73.94        70.04      72.77   73.54
          Dev.std.      7.92       8.62      10.79        10.65      10.20    9.19
               Min     58.30      60.50      44.80        47.20      53.90   55.60
                Q1     70.90      68.80      68.20        65.90      68.20   66.95
           Mediana     74.10      71.60      73.60        68.50      72.75   73.75
                Q3     80.60      77.00      76.70        77.80      76.50   80.35
               Max     93.10      94.20      94.70        96.30      93.50   93.20
               DAP      6.52       5.49       7.56        12.31       6.45    9.93
                RI      9.70       8.20       8.50        11.90       8.15   13.35
                CV      0.10       0.12       0.15         0.15       0.14    0.12
         Asimetría      0.28       0.75       0.03         0.10       0.01    0.12
      ES-Asimetría      0.43       0.43       0.43         0.43       0.43    0.44
          Curtosis     -0.25      -0.42       0.45        -0.03      -0.60   -0.58
        Num.Válido     29.00      29.00      29.00        29.00      30.00   28.00
        Pct.Válido     96.67      96.67      96.67        96.67     100.00   93.33

> de1 %>% tb()
# A tibble: 6 x 16
  variable    mean    sd   min    q1   med    q3   max   mad   iqr    cv skewness se.skewness kurtosis n.valid pct.valid
  <chr>      <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
1 anglais     76.0  7.92  58.3  70.9  74.1  80.6  93.1  6.52  9.70 0.104   0.279        0.434  -0.251       29      96.7
2 economie    73.9  8.62  60.5  68.8  71.6  77    94.2  5.49  8.2  0.117   0.753        0.434  -0.422       29      96.7
3 francais    73.9 10.8   44.8  68.2  73.6  76.7  94.7  7.56  8.5  0.146   0.0289       0.434   0.445       29      96.7
4 geographie  70.0 10.6   47.2  65.9  68.5  77.8  96.3 12.3  11.9  0.152   0.0958       0.434  -0.0290      29      96.7
5 histoire    72.8 10.2   53.9  68.2  72.8  76.5  93.5  6.45  8.15 0.140   0.0120       0.427  -0.596       30     100  
6 maths       73.5  9.19  55.6  67.0  73.8  80.4  93.2  9.93 13.3  0.125   0.116        0.441  -0.579       28      93.3

> de1 %>% tb(2) # no difference expected
# A tibble: 6 x 16
  variable    mean    sd   min    q1   med    q3   max   mad   iqr    cv skewness se.skewness kurtosis n.valid pct.valid
  <chr>      <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
1 anglais     76.0  7.92  58.3  70.9  74.1  80.6  93.1  6.52  9.70 0.104   0.279        0.434  -0.251       29      96.7
2 economie    73.9  8.62  60.5  68.8  71.6  77    94.2  5.49  8.2  0.117   0.753        0.434  -0.422       29      96.7
3 francais    73.9 10.8   44.8  68.2  73.6  76.7  94.7  7.56  8.5  0.146   0.0289       0.434   0.445       29      96.7
4 geographie  70.0 10.6   47.2  65.9  68.5  77.8  96.3 12.3  11.9  0.152   0.0958       0.434  -0.0290      29      96.7
5 histoire    72.8 10.2   53.9  68.2  72.8  76.5  93.5  6.45  8.15 0.140   0.0120       0.427  -0.596       30     100  
6 maths       73.5  9.19  55.6  67.0  73.8  80.4  93.2  9.93 13.3  0.125   0.116        0.441  -0.579       28      93.3

> (de2 <- examens$francais %>% descr())
Estadísticas descriptivas  
examens$francais  
N: 30  

                     francais
------------------ ----------
             Media      73.94
          Dev.std.      10.79
               Min      44.80
                Q1      68.20
           Mediana      73.60
                Q3      76.70
               Max      94.70
               DAP       7.56
                RI       8.50
                CV       0.15
         Asimetría       0.03
      ES-Asimetría       0.43
          Curtosis       0.45
        Num.Válido      29.00
        Pct.Válido      96.67

> de2 %>% tb()
# A tibble: 1 x 16
  variable  mean    sd   min    q1   med    q3   max   mad   iqr    cv skewness se.skewness kurtosis n.valid pct.valid
  <chr>    <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
1 francais  73.9  10.8  44.8  68.2  73.6  76.7  94.7  7.56   8.5 0.146   0.0289       0.434    0.445      29      96.7

> de2 %>% tb(drop.var.col = T)
# A tibble: 1 x 15
   mean    sd   min    q1   med    q3   max   mad   iqr    cv skewness se.skewness kurtosis n.valid pct.valid
  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
1  73.9  10.8  44.8  68.2  73.6  76.7  94.7  7.56   8.5 0.146   0.0289       0.434    0.445      29      96.7

# -----------------  Descr with grouped results, one variable only
> (dgr1 <- examens %$% stby(maths, sexe, descr, stats = "common"))
Estadísticas descriptivas  
maths por sexe  
Data frame: examens  
N: 15  

                   Fille   Garçon
---------------- ------- --------
           Media   73.78    73.31
        Dev.std.    9.03     9.68
             Min   55.60    60.50
         Mediana   74.80    72.25
             Max   86.30    93.20
      Num.Válido   14.00    14.00
      Pct.Válido   93.33    93.33

> dgr1 %>% tb()
# A tibble: 2 x 9
  sexe   variable  mean    sd   min   med   max n.valid pct.valid
  <fct>  <chr>    <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl>     <dbl>
1 Fille  maths     73.8  9.03  55.6  74.8  86.3      14      93.3
2 Garçon maths     73.3  9.68  60.5  72.2  93.2      14      93.3

> identical(dgr1 %>% tb(2), dgr1 %>% tb())
[1] TRUE

# -----------------  Descr with grouped results, complete df
> (dgr2 <- stby(examens, examens$sexe, descr))
Non-numerical variable(s) ignored: eleve, sexe
Estadísticas descriptivas  
examens  
Subgrupo: sexe = Fille  
N: 15  

                     anglais   economie   francais   geographie   histoire   maths
------------------ --------- ---------- ---------- ------------ ---------- -------
             Media     73.94      72.51      71.11        67.27      71.17   73.78
          Dev.std.      9.41       7.79      12.40         8.26       9.17    9.03
               Min     58.30      62.30      44.80        50.40      53.90   55.60
                Q1     69.70      68.50      65.30        59.80      67.30   68.80
           Mediana     71.80      70.20      68.35        67.30      72.90   74.80
                Q3     80.60      72.50      74.90        73.60      76.30   80.60
               Max     93.10      89.60      93.70        78.90      86.40   86.30
               DAP      6.15       3.34       7.26         9.34       5.34    8.75
                RI      9.12       3.85       9.23        10.20       8.55   11.05
                CV      0.13       0.11       0.17         0.12       0.13    0.12
         Asimetría      0.51       0.91       0.08        -0.34      -0.36   -0.50
      ES-Asimetría      0.60       0.60       0.60         0.58       0.58    0.60
          Curtosis     -0.66      -0.32      -0.15        -0.90      -0.68   -0.80
        Num.Válido     14.00      14.00      14.00        15.00      15.00   14.00
        Pct.Válido     93.33      93.33      93.33       100.00     100.00   93.33

Subgrupo: sexe = Garçon  
N: 15  

                     anglais   economie   francais   geographie   histoire   maths
------------------ --------- ---------- ---------- ------------ ---------- -------
             Media     77.85      75.21      76.58        73.00      74.37   73.31
          Dev.std.      5.94       9.40       8.63        12.35      11.21    9.68
               Min     69.60      60.50      63.20        47.20      54.40   60.50
                Q1     74.00      68.80      70.50        66.30      68.60   66.90
           Mediana     77.60      71.70      74.80        71.20      72.60   72.25
                Q3     80.90      82.60      76.90        82.70      86.10   77.40
               Max     90.20      94.20      94.70        96.30      93.50   93.20
               DAP      5.19       7.56       3.41        11.34      10.97    7.86
                RI      6.35      10.40       5.30        15.48      14.30   10.30
                CV      0.08       0.12       0.11         0.17       0.15    0.13
         Asimetría      0.73       0.51       0.78        -0.13       0.09    0.62
      ES-Asimetría      0.58       0.58       0.58         0.60       0.58    0.60
          Curtosis     -0.42      -0.84      -0.42        -0.48      -1.11   -0.64
        Num.Válido     15.00      15.00      15.00        14.00      15.00   14.00
        Pct.Válido    100.00     100.00     100.00        93.33     100.00   93.33

> dgr2 %>% tb()
# A tibble: 12 x 17
   sexe   variable    mean    sd   min    q1   med    q3   max   mad   iqr     cv skewness se.skewness kurtosis n.valid pct.valid
   <fct>  <chr>      <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>  <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
 1 Fille  anglais     73.9  9.41  58.3  69.7  71.8  80.6  93.1  6.15  9.12 0.127    0.509        0.597   -0.660      14      93.3
 2 Fille  economie    72.5  7.79  62.3  68.5  70.2  72.5  89.6  3.34  3.85 0.107    0.914        0.597   -0.319      14      93.3
 3 Fille  francais    71.1 12.4   44.8  65.3  68.4  74.9  93.7  7.26  9.23 0.174    0.0840       0.597   -0.150      14      93.3
 4 Fille  geographie  67.3  8.26  50.4  59.8  67.3  73.6  78.9  9.34 10.2  0.123   -0.338        0.580   -0.900      15     100  
 5 Fille  histoire    71.2  9.17  53.9  67.3  72.9  76.3  86.4  5.34  8.55 0.129   -0.365        0.580   -0.682      15     100  
 6 Fille  maths       73.8  9.03  55.6  68.8  74.8  80.6  86.3  8.75 11.0  0.122   -0.503        0.597   -0.798      14      93.3
 7 Garçon anglais     77.8  5.94  69.6  74    77.6  80.9  90.2  5.19  6.35 0.0763   0.726        0.580   -0.419      15     100  
 8 Garçon economie    75.2  9.40  60.5  68.8  71.7  82.6  94.2  7.56 10.4  0.125    0.513        0.580   -0.844      15     100  
 9 Garçon francais    76.6  8.63  63.2  70.5  74.8  76.9  94.7  3.41  5.3  0.113    0.783        0.580   -0.424      15     100  
10 Garçon geographie  73   12.4   47.2  66.3  71.2  82.7  96.3 11.3  15.5  0.169   -0.134        0.597   -0.477      14      93.3
11 Garçon histoire    74.4 11.2   54.4  68.6  72.6  86.1  93.5 11.0  14.3  0.151    0.0853       0.580   -1.11       15     100  
12 Garçon maths       73.3  9.68  60.5  66.9  72.2  77.4  93.2  7.86 10.3  0.132    0.617        0.597   -0.642      14      93.3

> dgr2 %>% tb(2)
# A tibble: 12 x 17
   sexe   variable    mean    sd   min    q1   med    q3   max   mad   iqr     cv skewness se.skewness kurtosis n.valid pct.valid
   <fct>  <chr>      <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>  <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
 1 Fille  anglais     73.9  9.41  58.3  69.7  71.8  80.6  93.1  6.15  9.12 0.127    0.509        0.597   -0.660      14      93.3
 2 Garçon anglais     77.8  5.94  69.6  74    77.6  80.9  90.2  5.19  6.35 0.0763   0.726        0.580   -0.419      15     100  
 3 Fille  economie    72.5  7.79  62.3  68.5  70.2  72.5  89.6  3.34  3.85 0.107    0.914        0.597   -0.319      14      93.3
 4 Garçon economie    75.2  9.40  60.5  68.8  71.7  82.6  94.2  7.56 10.4  0.125    0.513        0.580   -0.844      15     100  
 5 Fille  francais    71.1 12.4   44.8  65.3  68.4  74.9  93.7  7.26  9.23 0.174    0.0840       0.597   -0.150      14      93.3
 6 Garçon francais    76.6  8.63  63.2  70.5  74.8  76.9  94.7  3.41  5.3  0.113    0.783        0.580   -0.424      15     100  
 7 Fille  geographie  67.3  8.26  50.4  59.8  67.3  73.6  78.9  9.34 10.2  0.123   -0.338        0.580   -0.900      15     100  
 8 Garçon geographie  73   12.4   47.2  66.3  71.2  82.7  96.3 11.3  15.5  0.169   -0.134        0.597   -0.477      14      93.3
 9 Fille  histoire    71.2  9.17  53.9  67.3  72.9  76.3  86.4  5.34  8.55 0.129   -0.365        0.580   -0.682      15     100  
10 Garçon histoire    74.4 11.2   54.4  68.6  72.6  86.1  93.5 11.0  14.3  0.151    0.0853       0.580   -1.11       15     100  
11 Fille  maths       73.8  9.03  55.6  68.8  74.8  80.6  86.3  8.75 11.0  0.122   -0.503        0.597   -0.798      14      93.3
12 Garçon maths       73.3  9.68  60.5  66.9  72.2  77.4  93.2  7.86 10.3  0.132    0.617        0.597   -0.642      14      93.3

> dgr2 %>% tb(3)
# A tibble: 12 x 17
   variable   sexe    mean    sd   min    q1   med    q3   max   mad   iqr     cv skewness se.skewness kurtosis n.valid pct.valid
   <chr>      <fct>  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>  <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
 1 anglais    Fille   73.9  9.41  58.3  69.7  71.8  80.6  93.1  6.15  9.12 0.127    0.509        0.597   -0.660      14      93.3
 2 anglais    Garçon  77.8  5.94  69.6  74    77.6  80.9  90.2  5.19  6.35 0.0763   0.726        0.580   -0.419      15     100  
 3 economie   Fille   72.5  7.79  62.3  68.5  70.2  72.5  89.6  3.34  3.85 0.107    0.914        0.597   -0.319      14      93.3
 4 economie   Garçon  75.2  9.40  60.5  68.8  71.7  82.6  94.2  7.56 10.4  0.125    0.513        0.580   -0.844      15     100  
 5 francais   Fille   71.1 12.4   44.8  65.3  68.4  74.9  93.7  7.26  9.23 0.174    0.0840       0.597   -0.150      14      93.3
 6 francais   Garçon  76.6  8.63  63.2  70.5  74.8  76.9  94.7  3.41  5.3  0.113    0.783        0.580   -0.424      15     100  
 7 geographie Fille   67.3  8.26  50.4  59.8  67.3  73.6  78.9  9.34 10.2  0.123   -0.338        0.580   -0.900      15     100  
 8 geographie Garçon  73   12.4   47.2  66.3  71.2  82.7  96.3 11.3  15.5  0.169   -0.134        0.597   -0.477      14      93.3
 9 histoire   Fille   71.2  9.17  53.9  67.3  72.9  76.3  86.4  5.34  8.55 0.129   -0.365        0.580   -0.682      15     100  
10 histoire   Garçon  74.4 11.2   54.4  68.6  72.6  86.1  93.5 11.0  14.3  0.151    0.0853       0.580   -1.11       15     100  
11 maths      Fille   73.8  9.03  55.6  68.8  74.8  80.6  86.3  8.75 11.0  0.122   -0.503        0.597   -0.798      14      93.3
12 maths      Garçon  73.3  9.68  60.5  66.9  72.2  77.4  93.2  7.86 10.3  0.132    0.617        0.597   -0.642      14      93.3

> (dd1 <- stby(tobacco, tobacco$gender, descr))
Non-numerical variable(s) ignored: gender, age.gr, smoker, diseased, disease
Estadísticas descriptivas  
tobacco  
Subgrupo: gender = F  
N: 489  

                        age      BMI   cigs.per.day   samp.wgts
------------------ -------- -------- -------------- -----------
             Media    49.56    26.10           6.88        1.00
          Dev.std.    18.28     4.95          12.04        0.08
               Min    18.00     9.01           0.00        0.86
                Q1    34.00    22.98           0.00        0.86
           Mediana    50.00    25.87           0.00        1.04
                Q3    66.00    29.48          10.50        1.05
               Max    80.00    39.44          40.00        1.06
               DAP    23.72     4.75           0.00        0.01
                RI    32.00     6.49          10.25        0.19
                CV     0.37     0.19           1.75        0.08
         Asimetría    -0.04    -0.02           1.53       -1.03
      ES-Asimetría     0.11     0.11           0.11        0.11
          Curtosis    -1.25     0.09           0.85       -0.92
        Num.Válido   475.00   475.00         468.00      489.00
        Pct.Válido    97.14    97.14          95.71      100.00

Subgrupo: gender = M  
N: 489  

                        age      BMI   cigs.per.day   samp.wgts
------------------ -------- -------- -------------- -----------
             Media    49.58    25.31           6.72        1.00
          Dev.std.    18.34     3.98          11.83        0.08
               Min    18.00     8.83           0.00        0.86
                Q1    34.00    22.52           0.00        0.86
           Mediana    49.50    25.14           0.00        1.04
                Q3    66.00    27.96          11.00        1.05
               Max    80.00    36.76          40.00        1.06
               DAP    24.46     4.02           0.00        0.01
                RI    32.00     5.44          11.00        0.19
                CV     0.37     0.16           1.76        0.08
         Asimetría    -0.04    -0.04           1.54       -1.03
      ES-Asimetría     0.11     0.11           0.11        0.11
          Curtosis    -1.27     0.17           0.92       -0.92
        Num.Válido   478.00   477.00         475.00      489.00
        Pct.Válido    97.75    97.55          97.14      100.00

> dd1 %>% tb()
# A tibble: 8 x 17
  gender variable      mean      sd    min     q1   med    q3   max      mad    iqr     cv skewness se.skewness kurtosis n.valid pct.valid
  <fct>  <chr>        <dbl>   <dbl>  <dbl>  <dbl> <dbl> <dbl> <dbl>    <dbl>  <dbl>  <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
1 F      age          49.6  18.3    18     34     50    66    80    23.7     32     0.369   -0.0355       0.112  -1.25       475      97.1
2 F      BMI          26.1   4.95    9.01  23.0   25.9  29.5  39.4   4.75     6.49  0.190   -0.0226       0.112   0.0891     475      97.1
3 F      cigs.per.day  6.88 12.0     0      0      0    10.5  40     0       10.2   1.75     1.53         0.113   0.855      468      95.7
4 F      samp.wgts     1.00  0.0840  0.861  0.861  1.04  1.05  1.06  0.00772  0.188 0.0840  -1.03         0.110  -0.918      489     100  
5 M      age          49.6  18.3    18     34     49.5  66    80    24.5     32     0.370   -0.0403       0.112  -1.27       478      97.8
6 M      BMI          25.3   3.98    8.83  22.5   25.1  28.0  36.8   4.02     5.44  0.157   -0.0372       0.112   0.175      477      97.5
7 M      cigs.per.day  6.72 11.8     0      0      0    11    40     0       11     1.76     1.54         0.112   0.921      475      97.1
8 M      samp.wgts     1.00  0.0840  0.861  0.861  1.04  1.05  1.06  0.00772  0.188 0.0840  -1.03         0.110  -0.918      489     100  

> dd1 %>% tb(2)
# A tibble: 8 x 17
  gender variable      mean      sd    min     q1   med    q3   max      mad    iqr     cv skewness se.skewness kurtosis n.valid pct.valid
  <fct>  <chr>        <dbl>   <dbl>  <dbl>  <dbl> <dbl> <dbl> <dbl>    <dbl>  <dbl>  <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
1 F      age          49.6  18.3    18     34     50    66    80    23.7     32     0.369   -0.0355       0.112  -1.25       475      97.1
2 M      age          49.6  18.3    18     34     49.5  66    80    24.5     32     0.370   -0.0403       0.112  -1.27       478      97.8
3 F      BMI          26.1   4.95    9.01  23.0   25.9  29.5  39.4   4.75     6.49  0.190   -0.0226       0.112   0.0891     475      97.1
4 M      BMI          25.3   3.98    8.83  22.5   25.1  28.0  36.8   4.02     5.44  0.157   -0.0372       0.112   0.175      477      97.5
5 F      cigs.per.day  6.88 12.0     0      0      0    10.5  40     0       10.2   1.75     1.53         0.113   0.855      468      95.7
6 M      cigs.per.day  6.72 11.8     0      0      0    11    40     0       11     1.76     1.54         0.112   0.921      475      97.1
7 F      samp.wgts     1.00  0.0840  0.861  0.861  1.04  1.05  1.06  0.00772  0.188 0.0840  -1.03         0.110  -0.918      489     100  
8 M      samp.wgts     1.00  0.0840  0.861  0.861  1.04  1.05  1.06  0.00772  0.188 0.0840  -1.03         0.110  -0.918      489     100  

> dd1 %>% tb(3)
# A tibble: 8 x 17
  variable     gender  mean      sd    min     q1   med    q3   max      mad    iqr     cv skewness se.skewness kurtosis n.valid pct.valid
  <chr>        <fct>  <dbl>   <dbl>  <dbl>  <dbl> <dbl> <dbl> <dbl>    <dbl>  <dbl>  <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
1 age          F      49.6  18.3    18     34     50    66    80    23.7     32     0.369   -0.0355       0.112  -1.25       475      97.1
2 age          M      49.6  18.3    18     34     49.5  66    80    24.5     32     0.370   -0.0403       0.112  -1.27       478      97.8
3 BMI          F      26.1   4.95    9.01  23.0   25.9  29.5  39.4   4.75     6.49  0.190   -0.0226       0.112   0.0891     475      97.1
4 BMI          M      25.3   3.98    8.83  22.5   25.1  28.0  36.8   4.02     5.44  0.157   -0.0372       0.112   0.175      477      97.5
5 cigs.per.day F       6.88 12.0     0      0      0    10.5  40     0       10.2   1.75     1.53         0.113   0.855      468      95.7
6 cigs.per.day M       6.72 11.8     0      0      0    11    40     0       11     1.76     1.54         0.112   0.921      475      97.1
7 samp.wgts    F       1.00  0.0840  0.861  0.861  1.04  1.05  1.06  0.00772  0.188 0.0840  -1.03         0.110  -0.918      489     100  
8 samp.wgts    M       1.00  0.0840  0.861  0.861  1.04  1.05  1.06  0.00772  0.188 0.0840  -1.03         0.110  -0.918      489     100  

> view(dd1, file = "dd1.html")
Non-numerical variable(s) ignored: gender, age.gr, smoker, diseased, disease
Output file written
Output file appended

> tobacco$gender %<>% forcats::fct_explicit_na()

> (dd2 <- tobacco %>% group_by(gender) %>% descr(stats = "common"))
Non-numerical variable(s) ignored: age.gr, smoker, diseased, disease
Estadísticas descriptivas  
tobacco  
Subgrupo: gender = F  
N: 489  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    49.56    26.10           6.88        1.00
        Dev.std.    18.28     4.95          12.04        0.08
             Min    18.00     9.01           0.00        0.86
         Mediana    50.00    25.87           0.00        1.04
             Max    80.00    39.44          40.00        1.06
      Num.Válido   475.00   475.00         468.00      489.00
      Pct.Válido    97.14    97.14          95.71      100.00

Subgrupo: gender = M  
N: 489  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    49.58    25.31           6.72        1.00
        Dev.std.    18.34     3.98          11.83        0.08
             Min    18.00     8.83           0.00        0.86
         Mediana    49.50    25.14           0.00        1.04
             Max    80.00    36.76          40.00        1.06
      Num.Válido   478.00   477.00         475.00      489.00
      Pct.Válido    97.75    97.55          97.14      100.00

Subgrupo: gender = (Missing)  
N: 22  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    50.86    26.95           6.09        1.01
        Dev.std.    18.23     3.51           9.72        0.08
             Min    19.00    20.24           0.00        0.86
         Mediana    55.50    27.16           0.00        1.05
             Max    80.00    32.43          28.00        1.06
      Num.Válido    22.00    22.00          22.00       22.00
      Pct.Válido   100.00   100.00         100.00      100.00

> dd2 %>% tb()
# A tibble: 12 x 9
   gender    variable      mean      sd    min   med   max n.valid pct.valid
   <fct>     <chr>        <dbl>   <dbl>  <dbl> <dbl> <dbl>   <dbl>     <dbl>
 1 F         age          49.6  18.3    18     50    80        475      97.1
 2 F         BMI          26.1   4.95    9.01  25.9  39.4      475      97.1
 3 F         cigs.per.day  6.88 12.0     0      0    40        468      95.7
 4 F         samp.wgts     1.00  0.0840  0.861  1.04  1.06     489     100  
 5 M         age          49.6  18.3    18     49.5  80        478      97.8
 6 M         BMI          25.3   3.98    8.83  25.1  36.8      477      97.5
 7 M         cigs.per.day  6.72 11.8     0      0    40        475      97.1
 8 M         samp.wgts     1.00  0.0840  0.861  1.04  1.06     489     100  
 9 (Missing) age          50.9  18.2    19     55.5  80         22     100  
10 (Missing) BMI          26.9   3.51   20.2   27.2  32.4       22     100  
11 (Missing) cigs.per.day  6.09  9.72    0      0    28         22     100  
12 (Missing) samp.wgts     1.01  0.0811  0.861  1.05  1.06      22     100  

> dd2 %>% tb(2)
# A tibble: 12 x 9
   gender    variable      mean      sd    min   med   max n.valid pct.valid
   <fct>     <chr>        <dbl>   <dbl>  <dbl> <dbl> <dbl>   <dbl>     <dbl>
 1 F         age          49.6  18.3    18     50    80        475      97.1
 2 M         age          49.6  18.3    18     49.5  80        478      97.8
 3 (Missing) age          50.9  18.2    19     55.5  80         22     100  
 4 F         BMI          26.1   4.95    9.01  25.9  39.4      475      97.1
 5 M         BMI          25.3   3.98    8.83  25.1  36.8      477      97.5
 6 (Missing) BMI          26.9   3.51   20.2   27.2  32.4       22     100  
 7 F         cigs.per.day  6.88 12.0     0      0    40        468      95.7
 8 M         cigs.per.day  6.72 11.8     0      0    40        475      97.1
 9 (Missing) cigs.per.day  6.09  9.72    0      0    28         22     100  
10 F         samp.wgts     1.00  0.0840  0.861  1.04  1.06     489     100  
11 M         samp.wgts     1.00  0.0840  0.861  1.04  1.06     489     100  
12 (Missing) samp.wgts     1.01  0.0811  0.861  1.05  1.06      22     100  

> view(dd2, file = "dd2.html")
Non-numerical variable(s) ignored: age.gr, smoker, diseased, disease
Output file written
Output file appended

> (dd3 <- with(tobacco, stby(tobacco, list(gender, age.gr), descr, stats = "common")))
Non-numerical variable(s) ignored: gender, age.gr, smoker, diseased, disease
Estadísticas descriptivas  
tobacco  
Subgrupo: gender = F, age.gr = 18-34  
N: 123  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    25.98    24.25           5.87        0.86
        Dev.std.     4.71     4.75          11.19        0.00
             Min    18.00    12.98           0.00        0.86
         Mediana    26.00    24.22           0.00        0.86
             Max    34.00    34.84          38.00        0.86
      Num.Válido   123.00   121.00         119.00      123.00
      Pct.Válido   100.00    98.37          96.75      100.00

Subgrupo: gender = M, age.gr = 18-34  
N: 130  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    26.38    23.36           7.36        0.86
        Dev.std.     4.91     3.66          12.66        0.00
             Min    18.00     8.83           0.00        0.86
         Mediana    26.00    23.74           0.00        0.86
             Max    34.00    32.73          40.00        0.86
      Num.Válido   130.00   126.00         127.00      130.00
      Pct.Válido   100.00    96.92          97.69      100.00

Subgrupo: gender = (Missing), age.gr = 18-34  
N: 5  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    26.40    25.93           6.60        0.86
        Dev.std.     4.83     3.32          12.16        0.00
             Min    19.00    21.54           0.00        0.86
         Mediana    29.00    25.89           0.00        0.86
             Max    30.00    29.72          28.00        0.86
      Num.Válido     5.00     5.00           5.00        5.00
      Pct.Válido   100.00   100.00         100.00      100.00

Subgrupo: gender = F, age.gr = 35-50  
N: 118  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    41.99    25.55           6.68        1.04
        Dev.std.     4.54     4.84          11.58        0.00
             Min    35.00    10.35           0.00        1.04
         Mediana    42.00    25.66           0.00        1.04
             Max    50.00    39.44          40.00        1.04
      Num.Válido   118.00   112.00         115.00      118.00
      Pct.Válido   100.00    94.92          97.46      100.00

Subgrupo: gender = M, age.gr = 35-50  
N: 118  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    42.64    24.74           5.44        1.04
        Dev.std.     4.70     3.82          10.37        0.00
             Min    35.00    15.15           0.00        1.04
         Mediana    42.00    24.66           0.00        1.04
             Max    50.00    34.76          40.00        1.04
      Num.Válido   118.00   115.00         114.00      118.00
      Pct.Válido   100.00    97.46          96.61      100.00

Subgrupo: gender = (Missing), age.gr = 35-50  
N: 5  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    40.80    23.68           3.00        1.04
        Dev.std.     5.59     3.26           4.47        0.00
             Min    36.00    20.24           0.00        1.04
         Mediana    38.00    24.22           0.00        1.04
             Max    50.00    27.42          10.00        1.04
      Num.Válido     5.00     5.00           5.00        5.00
      Pct.Válido   100.00   100.00         100.00      100.00

Subgrupo: gender = F, age.gr = 51-70  
N: 157  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    61.00    27.08           7.20        1.05
        Dev.std.     5.70     4.88          12.58        0.00
             Min    51.00     9.01           0.00        1.05
         Mediana    61.00    26.91           0.00        1.05
             Max    70.00    39.21          40.00        1.05
      Num.Válido   157.00   154.00         153.00      157.00
      Pct.Válido   100.00    98.09          97.45      100.00

Subgrupo: gender = M, age.gr = 51-70  
N: 151  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    61.51    26.62           6.89        1.05
        Dev.std.     5.51     3.56          11.69        0.00
             Min    51.00    17.79           0.00        1.05
         Mediana    61.00    26.61           0.00        1.05
             Max    70.00    34.97          39.00        1.05
      Num.Válido   151.00   149.00         146.00      151.00
      Pct.Válido   100.00    98.68          96.69      100.00

Subgrupo: gender = (Missing), age.gr = 51-70  
N: 9  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    61.33    28.73           6.78        1.05
        Dev.std.     5.12     3.00          10.18        0.00
             Min    53.00    24.97           0.00        1.05
         Mediana    59.00    30.38           0.00        1.05
             Max    69.00    32.43          21.00        1.05
      Num.Válido     9.00     9.00           9.00        9.00
      Pct.Válido   100.00   100.00         100.00      100.00

Subgrupo: gender = F, age.gr = 71 +  
N: 77  

                      age     BMI   cigs.per.day   samp.wgts
---------------- -------- ------- -------------- -----------
           Media    75.52   28.01           7.65        1.06
        Dev.std.     2.94    4.60          12.88        0.00
             Min    71.00   18.36           0.00        1.06
         Mediana    76.00   27.65           0.00        1.06
             Max    80.00   38.37          40.00        1.06
      Num.Válido    77.00   75.00          69.00       77.00
      Pct.Válido   100.00   97.40          89.61      100.00

Subgrupo: gender = M, age.gr = 71 +  
N: 79  

                      age     BMI   cigs.per.day   samp.wgts
---------------- -------- ------- -------------- -----------
           Media    75.33   26.85           7.06        1.06
        Dev.std.     2.81    4.16          12.44        0.00
             Min    71.00   16.36           0.00        1.06
         Mediana    75.00   26.73           0.00        1.06
             Max    80.00   36.76          37.00        1.06
      Num.Válido    79.00   77.00          77.00       79.00
      Pct.Válido   100.00   97.47          97.47      100.00

Subgrupo: gender = (Missing), age.gr = 71 +  
N: 3  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    77.00    28.75           8.33        1.06
        Dev.std.     2.65     1.30          14.43        0.00
             Min    75.00    27.79           0.00        1.06
         Mediana    76.00    28.23           0.00        1.06
             Max    80.00    30.23          25.00        1.06
      Num.Válido     3.00     3.00           3.00        3.00
      Pct.Válido   100.00   100.00         100.00      100.00

> dd3 %>% tb()
# A tibble: 48 x 10
   gender    age.gr variable       mean    sd    min    med    max n.valid pct.valid
   <fct>     <fct>  <chr>         <dbl> <dbl>  <dbl>  <dbl>  <dbl>   <dbl>     <dbl>
 1 F         18-34  age          26.0    4.71 18     26     34         123     100  
 2 F         18-34  BMI          24.2    4.75 13.0   24.2   34.8       121      98.4
 3 F         18-34  cigs.per.day  5.87  11.2   0      0     38         119      96.7
 4 F         18-34  samp.wgts     0.861  0     0.861  0.861  0.861     123     100  
 5 F         35-50  age          42.0    4.54 35     42     50         118     100  
 6 F         35-50  BMI          25.6    4.84 10.3   25.7   39.4       112      94.9
 7 F         35-50  cigs.per.day  6.68  11.6   0      0     40         115      97.5
 8 F         35-50  samp.wgts     1.04   0     1.04   1.04   1.04      118     100  
 9 F         51-70  age          61      5.70 51     61     70         157     100  
10 F         51-70  BMI          27.1    4.88  9.01  26.9   39.2       154      98.1
11 F         51-70  cigs.per.day  7.20  12.6   0      0     40         153      97.5
12 F         51-70  samp.wgts     1.05   0     1.05   1.05   1.05      157     100  
13 F         71 +   age          75.5    2.94 71     76     80          77     100  
14 F         71 +   BMI          28.0    4.60 18.4   27.7   38.4        75      97.4
15 F         71 +   cigs.per.day  7.65  12.9   0      0     40          69      89.6
16 F         71 +   samp.wgts     1.06   0     1.06   1.06   1.06       77     100  
17 M         18-34  age          26.4    4.91 18     26     34         130     100  
18 M         18-34  BMI          23.4    3.66  8.83  23.7   32.7       126      96.9
19 M         18-34  cigs.per.day  7.36  12.7   0      0     40         127      97.7
20 M         18-34  samp.wgts     0.861  0     0.861  0.861  0.861     130     100  
21 M         35-50  age          42.6    4.70 35     42     50         118     100  
22 M         35-50  BMI          24.7    3.82 15.1   24.7   34.8       115      97.5
23 M         35-50  cigs.per.day  5.44  10.4   0      0     40         114      96.6
24 M         35-50  samp.wgts     1.04   0     1.04   1.04   1.04      118     100  
25 M         51-70  age          61.5    5.51 51     61     70         151     100  
26 M         51-70  BMI          26.6    3.56 17.8   26.6   35.0       149      98.7
27 M         51-70  cigs.per.day  6.89  11.7   0      0     39         146      96.7
28 M         51-70  samp.wgts     1.05   0     1.05   1.05   1.05      151     100  
29 M         71 +   age          75.3    2.81 71     75     80          79     100  
30 M         71 +   BMI          26.9    4.16 16.4   26.7   36.8        77      97.5
31 M         71 +   cigs.per.day  7.06  12.4   0      0     37          77      97.5
32 M         71 +   samp.wgts     1.06   0     1.06   1.06   1.06       79     100  
33 (Missing) 18-34  age          26.4    4.83 19     29     30           5     100  
34 (Missing) 18-34  BMI          25.9    3.32 21.5   25.9   29.7         5     100  
35 (Missing) 18-34  cigs.per.day  6.6   12.2   0      0     28           5     100  
36 (Missing) 18-34  samp.wgts     0.861  0     0.861  0.861  0.861       5     100  
37 (Missing) 35-50  age          40.8    5.59 36     38     50           5     100  
38 (Missing) 35-50  BMI          23.7    3.26 20.2   24.2   27.4         5     100  
39 (Missing) 35-50  cigs.per.day  3      4.47  0      0     10           5     100  
40 (Missing) 35-50  samp.wgts     1.04   0     1.04   1.04   1.04        5     100  
41 (Missing) 51-70  age          61.3    5.12 53     59     69           9     100  
42 (Missing) 51-70  BMI          28.7    3.00 25.0   30.4   32.4         9     100  
43 (Missing) 51-70  cigs.per.day  6.78  10.2   0      0     21           9     100  
44 (Missing) 51-70  samp.wgts     1.05   0     1.05   1.05   1.05        9     100  
45 (Missing) 71 +   age          77      2.65 75     76     80           3     100  
46 (Missing) 71 +   BMI          28.8    1.30 27.8   28.2   30.2         3     100  
47 (Missing) 71 +   cigs.per.day  8.33  14.4   0      0     25           3     100  
48 (Missing) 71 +   samp.wgts     1.06   0     1.06   1.06   1.06        3     100  

> dd3 %>% tb(2)
# A tibble: 48 x 10
   gender    age.gr variable       mean    sd    min    med    max n.valid pct.valid
   <fct>     <fct>  <chr>         <dbl> <dbl>  <dbl>  <dbl>  <dbl>   <dbl>     <dbl>
 1 F         18-34  age          26.0    4.71 18     26     34         123     100  
 2 F         35-50  age          42.0    4.54 35     42     50         118     100  
 3 F         51-70  age          61      5.70 51     61     70         157     100  
 4 F         71 +   age          75.5    2.94 71     76     80          77     100  
 5 M         18-34  age          26.4    4.91 18     26     34         130     100  
 6 M         35-50  age          42.6    4.70 35     42     50         118     100  
 7 M         51-70  age          61.5    5.51 51     61     70         151     100  
 8 M         71 +   age          75.3    2.81 71     75     80          79     100  
 9 (Missing) 18-34  age          26.4    4.83 19     29     30           5     100  
10 (Missing) 35-50  age          40.8    5.59 36     38     50           5     100  
11 (Missing) 51-70  age          61.3    5.12 53     59     69           9     100  
12 (Missing) 71 +   age          77      2.65 75     76     80           3     100  
13 F         18-34  BMI          24.2    4.75 13.0   24.2   34.8       121      98.4
14 F         35-50  BMI          25.6    4.84 10.3   25.7   39.4       112      94.9
15 F         51-70  BMI          27.1    4.88  9.01  26.9   39.2       154      98.1
16 F         71 +   BMI          28.0    4.60 18.4   27.7   38.4        75      97.4
17 M         18-34  BMI          23.4    3.66  8.83  23.7   32.7       126      96.9
18 M         35-50  BMI          24.7    3.82 15.1   24.7   34.8       115      97.5
19 M         51-70  BMI          26.6    3.56 17.8   26.6   35.0       149      98.7
20 M         71 +   BMI          26.9    4.16 16.4   26.7   36.8        77      97.5
21 (Missing) 18-34  BMI          25.9    3.32 21.5   25.9   29.7         5     100  
22 (Missing) 35-50  BMI          23.7    3.26 20.2   24.2   27.4         5     100  
23 (Missing) 51-70  BMI          28.7    3.00 25.0   30.4   32.4         9     100  
24 (Missing) 71 +   BMI          28.8    1.30 27.8   28.2   30.2         3     100  
25 F         18-34  cigs.per.day  5.87  11.2   0      0     38         119      96.7
26 F         35-50  cigs.per.day  6.68  11.6   0      0     40         115      97.5
27 F         51-70  cigs.per.day  7.20  12.6   0      0     40         153      97.5
28 F         71 +   cigs.per.day  7.65  12.9   0      0     40          69      89.6
29 M         18-34  cigs.per.day  7.36  12.7   0      0     40         127      97.7
30 M         35-50  cigs.per.day  5.44  10.4   0      0     40         114      96.6
31 M         51-70  cigs.per.day  6.89  11.7   0      0     39         146      96.7
32 M         71 +   cigs.per.day  7.06  12.4   0      0     37          77      97.5
33 (Missing) 18-34  cigs.per.day  6.6   12.2   0      0     28           5     100  
34 (Missing) 35-50  cigs.per.day  3      4.47  0      0     10           5     100  
35 (Missing) 51-70  cigs.per.day  6.78  10.2   0      0     21           9     100  
36 (Missing) 71 +   cigs.per.day  8.33  14.4   0      0     25           3     100  
37 F         18-34  samp.wgts     0.861  0     0.861  0.861  0.861     123     100  
38 F         35-50  samp.wgts     1.04   0     1.04   1.04   1.04      118     100  
39 F         51-70  samp.wgts     1.05   0     1.05   1.05   1.05      157     100  
40 F         71 +   samp.wgts     1.06   0     1.06   1.06   1.06       77     100  
41 M         18-34  samp.wgts     0.861  0     0.861  0.861  0.861     130     100  
42 M         35-50  samp.wgts     1.04   0     1.04   1.04   1.04      118     100  
43 M         51-70  samp.wgts     1.05   0     1.05   1.05   1.05      151     100  
44 M         71 +   samp.wgts     1.06   0     1.06   1.06   1.06       79     100  
45 (Missing) 18-34  samp.wgts     0.861  0     0.861  0.861  0.861       5     100  
46 (Missing) 35-50  samp.wgts     1.04   0     1.04   1.04   1.04        5     100  
47 (Missing) 51-70  samp.wgts     1.05   0     1.05   1.05   1.05        9     100  
48 (Missing) 71 +   samp.wgts     1.06   0     1.06   1.06   1.06        3     100  

> view(dd3, file = "dd3.html")
Non-numerical variable(s) ignored: gender, age.gr, smoker, diseased, disease
Output file written
Output file appended

> tobacco$age.gr %<>% forcats::fct_explicit_na()

> (dd4 <- tobacco %>% group_by(gender, age.gr) %>% descr(stats = "common"))
Non-numerical variable(s) ignored: smoker, diseased, disease
Estadísticas descriptivas  
tobacco  
Subgrupo: gender = F, age.gr = 18-34  
N: 123  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    25.98    24.25           5.87        0.86
        Dev.std.     4.71     4.75          11.19        0.00
             Min    18.00    12.98           0.00        0.86
         Mediana    26.00    24.22           0.00        0.86
             Max    34.00    34.84          38.00        0.86
      Num.Válido   123.00   121.00         119.00      123.00
      Pct.Válido   100.00    98.37          96.75      100.00

Subgrupo: gender = F, age.gr = 35-50  
N: 118  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    41.99    25.55           6.68        1.04
        Dev.std.     4.54     4.84          11.58        0.00
             Min    35.00    10.35           0.00        1.04
         Mediana    42.00    25.66           0.00        1.04
             Max    50.00    39.44          40.00        1.04
      Num.Válido   118.00   112.00         115.00      118.00
      Pct.Válido   100.00    94.92          97.46      100.00

Subgrupo: gender = F, age.gr = 51-70  
N: 157  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    61.00    27.08           7.20        1.05
        Dev.std.     5.70     4.88          12.58        0.00
             Min    51.00     9.01           0.00        1.05
         Mediana    61.00    26.91           0.00        1.05
             Max    70.00    39.21          40.00        1.05
      Num.Válido   157.00   154.00         153.00      157.00
      Pct.Válido   100.00    98.09          97.45      100.00

Subgrupo: gender = F, age.gr = 71 +  
N: 77  

                      age     BMI   cigs.per.day   samp.wgts
---------------- -------- ------- -------------- -----------
           Media    75.52   28.01           7.65        1.06
        Dev.std.     2.94    4.60          12.88        0.00
             Min    71.00   18.36           0.00        1.06
         Mediana    76.00   27.65           0.00        1.06
             Max    80.00   38.37          40.00        1.06
      Num.Válido    77.00   75.00          69.00       77.00
      Pct.Válido   100.00   97.40          89.61      100.00

Subgrupo: gender = F, age.gr = (Missing)  
N: 14  

                    age     BMI   cigs.per.day   samp.wgts
---------------- ------ ------- -------------- -----------
           Media     NA   25.37          10.17        0.94
        Dev.std.     NA    4.35          13.39        0.10
             Min     NA   18.84           0.00        0.86
         Mediana     NA   25.92           0.00        0.86
             Max     NA   31.83          31.00        1.06
      Num.Válido   0.00   13.00          12.00       14.00
      Pct.Válido     NA   92.86          85.71      100.00

Subgrupo: gender = M, age.gr = 18-34  
N: 130  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    26.38    23.36           7.36        0.86
        Dev.std.     4.91     3.66          12.66        0.00
             Min    18.00     8.83           0.00        0.86
         Mediana    26.00    23.74           0.00        0.86
             Max    34.00    32.73          40.00        0.86
      Num.Válido   130.00   126.00         127.00      130.00
      Pct.Válido   100.00    96.92          97.69      100.00

Subgrupo: gender = M, age.gr = 35-50  
N: 118  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    42.64    24.74           5.44        1.04
        Dev.std.     4.70     3.82          10.37        0.00
             Min    35.00    15.15           0.00        1.04
         Mediana    42.00    24.66           0.00        1.04
             Max    50.00    34.76          40.00        1.04
      Num.Válido   118.00   115.00         114.00      118.00
      Pct.Válido   100.00    97.46          96.61      100.00

Subgrupo: gender = M, age.gr = 51-70  
N: 151  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    61.51    26.62           6.89        1.05
        Dev.std.     5.51     3.56          11.69        0.00
             Min    51.00    17.79           0.00        1.05
         Mediana    61.00    26.61           0.00        1.05
             Max    70.00    34.97          39.00        1.05
      Num.Válido   151.00   149.00         146.00      151.00
      Pct.Válido   100.00    98.68          96.69      100.00

Subgrupo: gender = M, age.gr = 71 +  
N: 79  

                      age     BMI   cigs.per.day   samp.wgts
---------------- -------- ------- -------------- -----------
           Media    75.33   26.85           7.06        1.06
        Dev.std.     2.81    4.16          12.44        0.00
             Min    71.00   16.36           0.00        1.06
         Mediana    75.00   26.73           0.00        1.06
             Max    80.00   36.76          37.00        1.06
      Num.Válido    79.00   77.00          77.00       79.00
      Pct.Válido   100.00   97.47          97.47      100.00

Subgrupo: gender = M, age.gr = (Missing)  
N: 11  

                    age     BMI   cigs.per.day   samp.wgts
---------------- ------ ------- -------------- -----------
           Media     NA   24.90           8.00        1.03
        Dev.std.     NA    2.65          14.51        0.06
             Min     NA   20.27           0.00        0.86
         Mediana     NA   24.80           0.00        1.04
             Max     NA   30.52          36.00        1.05
      Num.Válido   0.00   10.00          11.00       11.00
      Pct.Válido     NA   90.91         100.00      100.00

Subgrupo: gender = (Missing), age.gr = 18-34  
N: 5  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    26.40    25.93           6.60        0.86
        Dev.std.     4.83     3.32          12.16        0.00
             Min    19.00    21.54           0.00        0.86
         Mediana    29.00    25.89           0.00        0.86
             Max    30.00    29.72          28.00        0.86
      Num.Válido     5.00     5.00           5.00        5.00
      Pct.Válido   100.00   100.00         100.00      100.00

Subgrupo: gender = (Missing), age.gr = 35-50  
N: 5  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    40.80    23.68           3.00        1.04
        Dev.std.     5.59     3.26           4.47        0.00
             Min    36.00    20.24           0.00        1.04
         Mediana    38.00    24.22           0.00        1.04
             Max    50.00    27.42          10.00        1.04
      Num.Válido     5.00     5.00           5.00        5.00
      Pct.Válido   100.00   100.00         100.00      100.00

Subgrupo: gender = (Missing), age.gr = 51-70  
N: 9  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    61.33    28.73           6.78        1.05
        Dev.std.     5.12     3.00          10.18        0.00
             Min    53.00    24.97           0.00        1.05
         Mediana    59.00    30.38           0.00        1.05
             Max    69.00    32.43          21.00        1.05
      Num.Válido     9.00     9.00           9.00        9.00
      Pct.Válido   100.00   100.00         100.00      100.00

Subgrupo: gender = (Missing), age.gr = 71 +  
N: 3  

                      age      BMI   cigs.per.day   samp.wgts
---------------- -------- -------- -------------- -----------
           Media    77.00    28.75           8.33        1.06
        Dev.std.     2.65     1.30          14.43        0.00
             Min    75.00    27.79           0.00        1.06
         Mediana    76.00    28.23           0.00        1.06
             Max    80.00    30.23          25.00        1.06
      Num.Válido     3.00     3.00           3.00        3.00
      Pct.Válido   100.00   100.00         100.00      100.00

> dd4 %>% tb()
# A tibble: 56 x 10
   gender    age.gr    variable       mean      sd    min    med    max n.valid pct.valid
   <fct>     <fct>     <chr>         <dbl>   <dbl>  <dbl>  <dbl>  <dbl>   <dbl>     <dbl>
 1 F         18-34     age          26.0    4.71   18     26     34         123     100  
 2 F         18-34     BMI          24.2    4.75   13.0   24.2   34.8       121      98.4
 3 F         18-34     cigs.per.day  5.87  11.2     0      0     38         119      96.7
 4 F         18-34     samp.wgts     0.861  0       0.861  0.861  0.861     123     100  
 5 F         35-50     age          42.0    4.54   35     42     50         118     100  
 6 F         35-50     BMI          25.6    4.84   10.3   25.7   39.4       112      94.9
 7 F         35-50     cigs.per.day  6.68  11.6     0      0     40         115      97.5
 8 F         35-50     samp.wgts     1.04   0       1.04   1.04   1.04      118     100  
 9 F         51-70     age          61      5.70   51     61     70         157     100  
10 F         51-70     BMI          27.1    4.88    9.01  26.9   39.2       154      98.1
11 F         51-70     cigs.per.day  7.20  12.6     0      0     40         153      97.5
12 F         51-70     samp.wgts     1.05   0       1.05   1.05   1.05      157     100  
13 F         71 +      age          75.5    2.94   71     76     80          77     100  
14 F         71 +      BMI          28.0    4.60   18.4   27.7   38.4        75      97.4
15 F         71 +      cigs.per.day  7.65  12.9     0      0     40          69      89.6
16 F         71 +      samp.wgts     1.06   0       1.06   1.06   1.06       77     100  
17 F         (Missing) age          NA     NA      NA     NA     NA           0      NA  
18 F         (Missing) BMI          25.4    4.35   18.8   25.9   31.8        13      92.9
19 F         (Missing) cigs.per.day 10.2   13.4     0      0     31          12      85.7
20 F         (Missing) samp.wgts     0.942  0.0968  0.861  0.861  1.06       14     100  
21 M         18-34     age          26.4    4.91   18     26     34         130     100  
22 M         18-34     BMI          23.4    3.66    8.83  23.7   32.7       126      96.9
23 M         18-34     cigs.per.day  7.36  12.7     0      0     40         127      97.7
24 M         18-34     samp.wgts     0.861  0       0.861  0.861  0.861     130     100  
25 M         35-50     age          42.6    4.70   35     42     50         118     100  
26 M         35-50     BMI          24.7    3.82   15.1   24.7   34.8       115      97.5
27 M         35-50     cigs.per.day  5.44  10.4     0      0     40         114      96.6
28 M         35-50     samp.wgts     1.04   0       1.04   1.04   1.04      118     100  
29 M         51-70     age          61.5    5.51   51     61     70         151     100  
30 M         51-70     BMI          26.6    3.56   17.8   26.6   35.0       149      98.7
31 M         51-70     cigs.per.day  6.89  11.7     0      0     39         146      96.7
32 M         51-70     samp.wgts     1.05   0       1.05   1.05   1.05      151     100  
33 M         71 +      age          75.3    2.81   71     75     80          79     100  
34 M         71 +      BMI          26.9    4.16   16.4   26.7   36.8        77      97.5
35 M         71 +      cigs.per.day  7.06  12.4     0      0     37          77      97.5
36 M         71 +      samp.wgts     1.06   0       1.06   1.06   1.06       79     100  
37 M         (Missing) age          NA     NA      NA     NA     NA           0      NA  
38 M         (Missing) BMI          24.9    2.65   20.3   24.8   30.5        10      90.9
39 M         (Missing) cigs.per.day  8     14.5     0      0     36          11     100  
40 M         (Missing) samp.wgts     1.03   0.0558  0.861  1.04   1.05       11     100  
41 (Missing) 18-34     age          26.4    4.83   19     29     30           5     100  
42 (Missing) 18-34     BMI          25.9    3.32   21.5   25.9   29.7         5     100  
43 (Missing) 18-34     cigs.per.day  6.6   12.2     0      0     28           5     100  
44 (Missing) 18-34     samp.wgts     0.861  0       0.861  0.861  0.861       5     100  
45 (Missing) 35-50     age          40.8    5.59   36     38     50           5     100  
46 (Missing) 35-50     BMI          23.7    3.26   20.2   24.2   27.4         5     100  
47 (Missing) 35-50     cigs.per.day  3      4.47    0      0     10           5     100  
48 (Missing) 35-50     samp.wgts     1.04   0       1.04   1.04   1.04        5     100  
49 (Missing) 51-70     age          61.3    5.12   53     59     69           9     100  
50 (Missing) 51-70     BMI          28.7    3.00   25.0   30.4   32.4         9     100  
51 (Missing) 51-70     cigs.per.day  6.78  10.2     0      0     21           9     100  
52 (Missing) 51-70     samp.wgts     1.05   0       1.05   1.05   1.05        9     100  
53 (Missing) 71 +      age          77      2.65   75     76     80           3     100  
54 (Missing) 71 +      BMI          28.8    1.30   27.8   28.2   30.2         3     100  
55 (Missing) 71 +      cigs.per.day  8.33  14.4     0      0     25           3     100  
56 (Missing) 71 +      samp.wgts     1.06   0       1.06   1.06   1.06        3     100  

> dd4 %>% tb(na.rm = TRUE) # no effect expected
# A tibble: 56 x 10
   gender    age.gr    variable       mean      sd    min    med    max n.valid pct.valid
   <fct>     <fct>     <chr>         <dbl>   <dbl>  <dbl>  <dbl>  <dbl>   <dbl>     <dbl>
 1 F         18-34     age          26.0    4.71   18     26     34         123     100  
 2 F         18-34     BMI          24.2    4.75   13.0   24.2   34.8       121      98.4
 3 F         18-34     cigs.per.day  5.87  11.2     0      0     38         119      96.7
 4 F         18-34     samp.wgts     0.861  0       0.861  0.861  0.861     123     100  
 5 F         35-50     age          42.0    4.54   35     42     50         118     100  
 6 F         35-50     BMI          25.6    4.84   10.3   25.7   39.4       112      94.9
 7 F         35-50     cigs.per.day  6.68  11.6     0      0     40         115      97.5
 8 F         35-50     samp.wgts     1.04   0       1.04   1.04   1.04      118     100  
 9 F         51-70     age          61      5.70   51     61     70         157     100  
10 F         51-70     BMI          27.1    4.88    9.01  26.9   39.2       154      98.1
11 F         51-70     cigs.per.day  7.20  12.6     0      0     40         153      97.5
12 F         51-70     samp.wgts     1.05   0       1.05   1.05   1.05      157     100  
13 F         71 +      age          75.5    2.94   71     76     80          77     100  
14 F         71 +      BMI          28.0    4.60   18.4   27.7   38.4        75      97.4
15 F         71 +      cigs.per.day  7.65  12.9     0      0     40          69      89.6
16 F         71 +      samp.wgts     1.06   0       1.06   1.06   1.06       77     100  
17 F         (Missing) age          NA     NA      NA     NA     NA           0      NA  
18 F         (Missing) BMI          25.4    4.35   18.8   25.9   31.8        13      92.9
19 F         (Missing) cigs.per.day 10.2   13.4     0      0     31          12      85.7
20 F         (Missing) samp.wgts     0.942  0.0968  0.861  0.861  1.06       14     100  
21 M         18-34     age          26.4    4.91   18     26     34         130     100  
22 M         18-34     BMI          23.4    3.66    8.83  23.7   32.7       126      96.9
23 M         18-34     cigs.per.day  7.36  12.7     0      0     40         127      97.7
24 M         18-34     samp.wgts     0.861  0       0.861  0.861  0.861     130     100  
25 M         35-50     age          42.6    4.70   35     42     50         118     100  
26 M         35-50     BMI          24.7    3.82   15.1   24.7   34.8       115      97.5
27 M         35-50     cigs.per.day  5.44  10.4     0      0     40         114      96.6
28 M         35-50     samp.wgts     1.04   0       1.04   1.04   1.04      118     100  
29 M         51-70     age          61.5    5.51   51     61     70         151     100  
30 M         51-70     BMI          26.6    3.56   17.8   26.6   35.0       149      98.7
31 M         51-70     cigs.per.day  6.89  11.7     0      0     39         146      96.7
32 M         51-70     samp.wgts     1.05   0       1.05   1.05   1.05      151     100  
33 M         71 +      age          75.3    2.81   71     75     80          79     100  
34 M         71 +      BMI          26.9    4.16   16.4   26.7   36.8        77      97.5
35 M         71 +      cigs.per.day  7.06  12.4     0      0     37          77      97.5
36 M         71 +      samp.wgts     1.06   0       1.06   1.06   1.06       79     100  
37 M         (Missing) age          NA     NA      NA     NA     NA           0      NA  
38 M         (Missing) BMI          24.9    2.65   20.3   24.8   30.5        10      90.9
39 M         (Missing) cigs.per.day  8     14.5     0      0     36          11     100  
40 M         (Missing) samp.wgts     1.03   0.0558  0.861  1.04   1.05       11     100  
41 (Missing) 18-34     age          26.4    4.83   19     29     30           5     100  
42 (Missing) 18-34     BMI          25.9    3.32   21.5   25.9   29.7         5     100  
43 (Missing) 18-34     cigs.per.day  6.6   12.2     0      0     28           5     100  
44 (Missing) 18-34     samp.wgts     0.861  0       0.861  0.861  0.861       5     100  
45 (Missing) 35-50     age          40.8    5.59   36     38     50           5     100  
46 (Missing) 35-50     BMI          23.7    3.26   20.2   24.2   27.4         5     100  
47 (Missing) 35-50     cigs.per.day  3      4.47    0      0     10           5     100  
48 (Missing) 35-50     samp.wgts     1.04   0       1.04   1.04   1.04        5     100  
49 (Missing) 51-70     age          61.3    5.12   53     59     69           9     100  
50 (Missing) 51-70     BMI          28.7    3.00   25.0   30.4   32.4         9     100  
51 (Missing) 51-70     cigs.per.day  6.78  10.2     0      0     21           9     100  
52 (Missing) 51-70     samp.wgts     1.05   0       1.05   1.05   1.05        9     100  
53 (Missing) 71 +      age          77      2.65   75     76     80           3     100  
54 (Missing) 71 +      BMI          28.8    1.30   27.8   28.2   30.2         3     100  
55 (Missing) 71 +      cigs.per.day  8.33  14.4     0      0     25           3     100  
56 (Missing) 71 +      samp.wgts     1.06   0       1.06   1.06   1.06        3     100  

> dd4 %>% tb(order = 2)
# A tibble: 56 x 10
   gender    age.gr    variable       mean      sd    min    med    max n.valid pct.valid
   <fct>     <fct>     <chr>         <dbl>   <dbl>  <dbl>  <dbl>  <dbl>   <dbl>     <dbl>
 1 F         18-34     age          26.0    4.71   18     26     34         123     100  
 2 F         35-50     age          42.0    4.54   35     42     50         118     100  
 3 F         51-70     age          61      5.70   51     61     70         157     100  
 4 F         71 +      age          75.5    2.94   71     76     80          77     100  
 5 F         (Missing) age          NA     NA      NA     NA     NA           0      NA  
 6 M         18-34     age          26.4    4.91   18     26     34         130     100  
 7 M         35-50     age          42.6    4.70   35     42     50         118     100  
 8 M         51-70     age          61.5    5.51   51     61     70         151     100  
 9 M         71 +      age          75.3    2.81   71     75     80          79     100  
10 M         (Missing) age          NA     NA      NA     NA     NA           0      NA  
11 (Missing) 18-34     age          26.4    4.83   19     29     30           5     100  
12 (Missing) 35-50     age          40.8    5.59   36     38     50           5     100  
13 (Missing) 51-70     age          61.3    5.12   53     59     69           9     100  
14 (Missing) 71 +      age          77      2.65   75     76     80           3     100  
15 F         18-34     BMI          24.2    4.75   13.0   24.2   34.8       121      98.4
16 F         35-50     BMI          25.6    4.84   10.3   25.7   39.4       112      94.9
17 F         51-70     BMI          27.1    4.88    9.01  26.9   39.2       154      98.1
18 F         71 +      BMI          28.0    4.60   18.4   27.7   38.4        75      97.4
19 F         (Missing) BMI          25.4    4.35   18.8   25.9   31.8        13      92.9
20 M         18-34     BMI          23.4    3.66    8.83  23.7   32.7       126      96.9
21 M         35-50     BMI          24.7    3.82   15.1   24.7   34.8       115      97.5
22 M         51-70     BMI          26.6    3.56   17.8   26.6   35.0       149      98.7
23 M         71 +      BMI          26.9    4.16   16.4   26.7   36.8        77      97.5
24 M         (Missing) BMI          24.9    2.65   20.3   24.8   30.5        10      90.9
25 (Missing) 18-34     BMI          25.9    3.32   21.5   25.9   29.7         5     100  
26 (Missing) 35-50     BMI          23.7    3.26   20.2   24.2   27.4         5     100  
27 (Missing) 51-70     BMI          28.7    3.00   25.0   30.4   32.4         9     100  
28 (Missing) 71 +      BMI          28.8    1.30   27.8   28.2   30.2         3     100  
29 F         18-34     cigs.per.day  5.87  11.2     0      0     38         119      96.7
30 F         35-50     cigs.per.day  6.68  11.6     0      0     40         115      97.5
31 F         51-70     cigs.per.day  7.20  12.6     0      0     40         153      97.5
32 F         71 +      cigs.per.day  7.65  12.9     0      0     40          69      89.6
33 F         (Missing) cigs.per.day 10.2   13.4     0      0     31          12      85.7
34 M         18-34     cigs.per.day  7.36  12.7     0      0     40         127      97.7
35 M         35-50     cigs.per.day  5.44  10.4     0      0     40         114      96.6
36 M         51-70     cigs.per.day  6.89  11.7     0      0     39         146      96.7
37 M         71 +      cigs.per.day  7.06  12.4     0      0     37          77      97.5
38 M         (Missing) cigs.per.day  8     14.5     0      0     36          11     100  
39 (Missing) 18-34     cigs.per.day  6.6   12.2     0      0     28           5     100  
40 (Missing) 35-50     cigs.per.day  3      4.47    0      0     10           5     100  
41 (Missing) 51-70     cigs.per.day  6.78  10.2     0      0     21           9     100  
42 (Missing) 71 +      cigs.per.day  8.33  14.4     0      0     25           3     100  
43 F         18-34     samp.wgts     0.861  0       0.861  0.861  0.861     123     100  
44 F         35-50     samp.wgts     1.04   0       1.04   1.04   1.04      118     100  
45 F         51-70     samp.wgts     1.05   0       1.05   1.05   1.05      157     100  
46 F         71 +      samp.wgts     1.06   0       1.06   1.06   1.06       77     100  
47 F         (Missing) samp.wgts     0.942  0.0968  0.861  0.861  1.06       14     100  
48 M         18-34     samp.wgts     0.861  0       0.861  0.861  0.861     130     100  
49 M         35-50     samp.wgts     1.04   0       1.04   1.04   1.04      118     100  
50 M         51-70     samp.wgts     1.05   0       1.05   1.05   1.05      151     100  
51 M         71 +      samp.wgts     1.06   0       1.06   1.06   1.06       79     100  
52 M         (Missing) samp.wgts     1.03   0.0558  0.861  1.04   1.05       11     100  
53 (Missing) 18-34     samp.wgts     0.861  0       0.861  0.861  0.861       5     100  
54 (Missing) 35-50     samp.wgts     1.04   0       1.04   1.04   1.04        5     100  
55 (Missing) 51-70     samp.wgts     1.05   0       1.05   1.05   1.05        9     100  
56 (Missing) 71 +      samp.wgts     1.06   0       1.06   1.06   1.06        3     100  

> view(dd4, file = "dd4.html")
Non-numerical variable(s) ignored: smoker, diseased, disease
Output file written
Output file appended

# -----------------  freq
> data(tobacco)

> (ff1 <- stby(tobacco$smoker, tobacco$gender, freq))
Frecuencias  
tobacco$smoker  
Tipo: Factor  
Subgrupo: gender = F  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes     147      30.06           30.06     30.06          30.06
         No     342      69.94          100.00     69.94         100.00
       <NA>       0                                 0.00         100.00
      Total     489     100.00          100.00    100.00         100.00

Subgrupo: gender = M  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes     143      29.24           29.24     29.24          29.24
         No     346      70.76          100.00     70.76         100.00
       <NA>       0                                 0.00         100.00
      Total     489     100.00          100.00    100.00         100.00

> ff1 %>% tb()
# A tibble: 6 x 7
  gender smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
  <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
1 F      Yes      147      15.0          15.0    15.0        15.0
2 F      No       342      35.0          50.0    35.0        50.0
3 F      <NA>       0      NA            50.0     0          50.0
4 M      Yes      143      14.6          64.6    14.6        64.6
5 M      No       346      35.4         100      35.4       100  
6 M      <NA>       0      NA           100       0         100  

> ff1 %>% tb(2)
# A tibble: 6 x 7
  gender smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
  <fct>  <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
1 F      Yes      147      15.0          15.0    15.0        15.0
2 M      Yes      143      14.6          29.7    14.6        29.7
3 F      No       342      35.0          64.6    35.0        64.6
4 M      No       346      35.4         100      35.4       100  
5 F      <NA>       0      NA           100       0         100  
6 M      <NA>       0      NA           100       0         100  

> ff1 %>% tb(2, TRUE)
# A tibble: 4 x 5
  gender smoker  freq   pct pct_cum
  <fct>  <fct>  <dbl> <dbl>   <dbl>
1 F      Yes      147  15.0    15.0
2 M      Yes      143  14.6    29.7
3 F      No       342  35.0    64.6
4 M      No       346  35.4   100  

> view(ff1, file = "ff1.html")
Output file written
Output file appended

> (ff2 <- stby(tobacco$smoker, tobacco$gender, freq, report.nas = F))
Frecuencias  
tobacco$smoker  
Tipo: Factor  
Subgrupo: gender = F  

              Frec.        %   % Acu.
----------- ------- -------- --------
        Yes     147    30.06    30.06
         No     342    69.94   100.00
      Total     489   100.00   100.00

Subgrupo: gender = M  

              Frec.        %   % Acu.
----------- ------- -------- --------
        Yes     143    29.24    29.24
         No     346    70.76   100.00
      Total     489   100.00   100.00

> ff2 %>% tb()
# A tibble: 4 x 5
  gender smoker  freq   pct pct_cum
  <fct>  <fct>  <dbl> <dbl>   <dbl>
1 F      Yes      147  15.0    15.0
2 F      No       342  35.0    50.0
3 M      Yes      143  14.6    64.6
4 M      No       346  35.4   100  

> ff2 %>% tb(2)
# A tibble: 4 x 5
  gender smoker  freq   pct pct_cum
  <fct>  <fct>  <dbl> <dbl>   <dbl>
1 F      Yes      147  15.0    15.0
2 M      Yes      143  14.6    29.7
3 F      No       342  35.0    64.6
4 M      No       346  35.4   100  

> ff2 %>% tb(3)
# A tibble: 4 x 5
  smoker gender  freq   pct pct_cum
  <fct>  <fct>  <dbl> <dbl>   <dbl>
1 Yes    F        147  15.0    15.0
2 Yes    M        143  14.6    29.7
3 No     F        342  35.0    64.6
4 No     M        346  35.4   100  

> tobacco$gender %<>% forcats::fct_explicit_na()

> (ff3 <- tobacco %>% group_by(gender) %>% select(gender, smoker) %>% freq())
Frecuencias  
tobacco$smoker  
Tipo: Factor  
Subgrupo: gender = F  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes     147      30.06           30.06     30.06          30.06
         No     342      69.94          100.00     69.94         100.00
       <NA>       0                                 0.00         100.00
      Total     489     100.00          100.00    100.00         100.00

Subgrupo: gender = M  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes     143      29.24           29.24     29.24          29.24
         No     346      70.76          100.00     70.76         100.00
       <NA>       0                                 0.00         100.00
      Total     489     100.00          100.00    100.00         100.00

Subgrupo: gender = (Missing)  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes       8      36.36           36.36     36.36          36.36
         No      14      63.64          100.00     63.64         100.00
       <NA>       0                                 0.00         100.00
      Total      22     100.00          100.00    100.00         100.00

> ff3 %>% tb()
# A tibble: 9 x 7
  gender    smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
  <fct>     <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
1 F         Yes      147     10.0           10.0   10.0         10.0
2 F         No       342     23.3           33.3   23.3         33.3
3 F         <NA>       0     NA             33.3    0           33.3
4 M         Yes      143      9.75          43.1    9.75        43.1
5 M         No       346     23.6           66.7   23.6         66.7
6 M         <NA>       0     NA             66.7    0           66.7
7 (Missing) Yes        8     12.1           78.8   12.1         78.8
8 (Missing) No        14     21.2          100     21.2        100  
9 (Missing) <NA>       0     NA            100      0          100  

> ff3 %>% tb(2)
# A tibble: 9 x 7
  gender    smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
  <fct>     <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
1 F         Yes      147     10.0           10.0   10.0         10.0
2 M         Yes      143      9.75          19.8    9.75        19.8
3 (Missing) Yes        8     12.1           31.9   12.1         31.9
4 F         No       342     23.3           55.2   23.3         55.2
5 M         No       346     23.6           78.8   23.6         78.8
6 (Missing) No        14     21.2          100     21.2        100  
7 F         <NA>       0     NA            100      0          100  
8 M         <NA>       0     NA            100      0          100  
9 (Missing) <NA>       0     NA            100      0          100  

> ff3 %>% tb(2, TRUE)
# A tibble: 6 x 5
  gender    smoker  freq   pct pct_cum
  <fct>     <fct>  <dbl> <dbl>   <dbl>
1 F         Yes      147 10.0     10.0
2 M         Yes      143  9.75    19.8
3 (Missing) Yes        8 12.1     31.9
4 F         No       342 23.3     55.2
5 M         No       346 23.6     78.8
6 (Missing) No        14 21.2    100  

> view(ff3, file = "ff3.html")
Output file written
Output file appended

# -----------------  fails for unknown reason, only when sourcing from main script (00-Main.R)
> (ff4 <- with(tobacco, stby(smoker, list(gender, age.gr), freq)))
Frecuencias  
tobacco$smoker  
Tipo: Factor  
Subgrupo: gender = F, age.gr = 18-34  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      34      27.64           27.64     27.64          27.64
         No      89      72.36          100.00     72.36         100.00
       <NA>       0                                 0.00         100.00
      Total     123     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = 18-34  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      38      29.23           29.23     29.23          29.23
         No      92      70.77          100.00     70.77         100.00
       <NA>       0                                 0.00         100.00
      Total     130     100.00          100.00    100.00         100.00

Subgrupo: gender = (Missing), age.gr = 18-34  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes       2      40.00           40.00     40.00          40.00
         No       3      60.00          100.00     60.00         100.00
       <NA>       0                                 0.00         100.00
      Total       5     100.00          100.00    100.00         100.00

Subgrupo: gender = F, age.gr = 35-50  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      39      33.05           33.05     33.05          33.05
         No      79      66.95          100.00     66.95         100.00
       <NA>       0                                 0.00         100.00
      Total     118     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = 35-50  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      31      26.27           26.27     26.27          26.27
         No      87      73.73          100.00     73.73         100.00
       <NA>       0                                 0.00         100.00
      Total     118     100.00          100.00    100.00         100.00

Subgrupo: gender = (Missing), age.gr = 35-50  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes       2      40.00           40.00     40.00          40.00
         No       3      60.00          100.00     60.00         100.00
       <NA>       0                                 0.00         100.00
      Total       5     100.00          100.00    100.00         100.00

Subgrupo: gender = F, age.gr = 51-70  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      48      30.57           30.57     30.57          30.57
         No     109      69.43          100.00     69.43         100.00
       <NA>       0                                 0.00         100.00
      Total     157     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = 51-70  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      48      31.79           31.79     31.79          31.79
         No     103      68.21          100.00     68.21         100.00
       <NA>       0                                 0.00         100.00
      Total     151     100.00          100.00    100.00         100.00

Subgrupo: gender = (Missing), age.gr = 51-70  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes       3      33.33           33.33     33.33          33.33
         No       6      66.67          100.00     66.67         100.00
       <NA>       0                                 0.00         100.00
      Total       9     100.00          100.00    100.00         100.00

Subgrupo: gender = F, age.gr = 71 +  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      21      27.27           27.27     27.27          27.27
         No      56      72.73          100.00     72.73         100.00
       <NA>       0                                 0.00         100.00
      Total      77     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = 71 +  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      23      29.11           29.11     29.11          29.11
         No      56      70.89          100.00     70.89         100.00
       <NA>       0                                 0.00         100.00
      Total      79     100.00          100.00    100.00         100.00

Subgrupo: gender = (Missing), age.gr = 71 +  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes       1      33.33           33.33     33.33          33.33
         No       2      66.67          100.00     66.67         100.00
       <NA>       0                                 0.00         100.00
      Total       3     100.00          100.00    100.00         100.00

# -----------------  ff4 %>% tb()
# -----------------  ff4 %>% tb(2)
> 
> tobacco$age.gr %<>% forcats::fct_explicit_na()

> (ff5 <- tobacco %>% group_by(gender, age.gr) %>% select(gender, age.gr, smoker) %>% freq())
Frecuencias  
tobacco$smoker  
Tipo: Factor  
Subgrupo: gender = F, age.gr = 18-34  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      34      27.64           27.64     27.64          27.64
         No      89      72.36          100.00     72.36         100.00
       <NA>       0                                 0.00         100.00
      Total     123     100.00          100.00    100.00         100.00

Subgrupo: gender = F, age.gr = 35-50  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      39      33.05           33.05     33.05          33.05
         No      79      66.95          100.00     66.95         100.00
       <NA>       0                                 0.00         100.00
      Total     118     100.00          100.00    100.00         100.00

Subgrupo: gender = F, age.gr = 51-70  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      48      30.57           30.57     30.57          30.57
         No     109      69.43          100.00     69.43         100.00
       <NA>       0                                 0.00         100.00
      Total     157     100.00          100.00    100.00         100.00

Subgrupo: gender = F, age.gr = 71 +  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      21      27.27           27.27     27.27          27.27
         No      56      72.73          100.00     72.73         100.00
       <NA>       0                                 0.00         100.00
      Total      77     100.00          100.00    100.00         100.00

Subgrupo: gender = F, age.gr = (Missing)  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes       5      35.71           35.71     35.71          35.71
         No       9      64.29          100.00     64.29         100.00
       <NA>       0                                 0.00         100.00
      Total      14     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = 18-34  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      38      29.23           29.23     29.23          29.23
         No      92      70.77          100.00     70.77         100.00
       <NA>       0                                 0.00         100.00
      Total     130     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = 35-50  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      31      26.27           26.27     26.27          26.27
         No      87      73.73          100.00     73.73         100.00
       <NA>       0                                 0.00         100.00
      Total     118     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = 51-70  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      48      31.79           31.79     31.79          31.79
         No     103      68.21          100.00     68.21         100.00
       <NA>       0                                 0.00         100.00
      Total     151     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = 71 +  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes      23      29.11           29.11     29.11          29.11
         No      56      70.89          100.00     70.89         100.00
       <NA>       0                                 0.00         100.00
      Total      79     100.00          100.00    100.00         100.00

Subgrupo: gender = M, age.gr = (Missing)  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes       3      27.27           27.27     27.27          27.27
         No       8      72.73          100.00     72.73         100.00
       <NA>       0                                 0.00         100.00
      Total      11     100.00          100.00    100.00         100.00

Subgrupo: gender = (Missing), age.gr = 18-34  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes       2      40.00           40.00     40.00          40.00
         No       3      60.00          100.00     60.00         100.00
       <NA>       0                                 0.00         100.00
      Total       5     100.00          100.00    100.00         100.00

Subgrupo: gender = (Missing), age.gr = 35-50  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes       2      40.00           40.00     40.00          40.00
         No       3      60.00          100.00     60.00         100.00
       <NA>       0                                 0.00         100.00
      Total       5     100.00          100.00    100.00         100.00

Subgrupo: gender = (Missing), age.gr = 51-70  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes       3      33.33           33.33     33.33          33.33
         No       6      66.67          100.00     66.67         100.00
       <NA>       0                                 0.00         100.00
      Total       9     100.00          100.00    100.00         100.00

Subgrupo: gender = (Missing), age.gr = 71 +  

              Frec.   % Válido   % Válido acu.   % Total   % Total acu.
----------- ------- ---------- --------------- --------- --------------
        Yes       1      33.33           33.33     33.33          33.33
         No       2      66.67          100.00     66.67         100.00
       <NA>       0                                 0.00         100.00
      Total       3     100.00          100.00    100.00         100.00

> view(ff5, file = "ff5.html")
Output file written
Output file appended

> ff5 %>% tb()
# A tibble: 42 x 8
   gender    age.gr    smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
   <fct>     <fct>     <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
 1 F         18-34     Yes       34      1.97          1.97    1.97        1.97
 2 F         18-34     No        89      5.17          7.14    5.17        7.14
 3 F         18-34     <NA>       0     NA             7.14    0           7.14
 4 F         35-50     Yes       39      2.36          9.50    2.36        9.50
 5 F         35-50     No        79      4.78         14.3     4.78       14.3 
 6 F         35-50     <NA>       0     NA            14.3     0          14.3 
 7 F         51-70     Yes       48      2.18         16.5     2.18       16.5 
 8 F         51-70     No       109      4.96         21.4     4.96       21.4 
 9 F         51-70     <NA>       0     NA            21.4     0          21.4 
10 F         71 +      Yes       21      1.95         23.4     1.95       23.4 
11 F         71 +      No        56      5.19         28.6     5.19       28.6 
12 F         71 +      <NA>       0     NA            28.6     0          28.6 
13 F         (Missing) Yes        5      2.55         31.1     2.55       31.1 
14 F         (Missing) No         9      4.59         35.7     4.59       35.7 
15 F         (Missing) <NA>       0     NA            35.7     0          35.7 
16 M         18-34     Yes       38      2.09         37.8     2.09       37.8 
17 M         18-34     No        92      5.05         42.9     5.05       42.9 
18 M         18-34     <NA>       0     NA            42.9     0          42.9 
19 M         35-50     Yes       31      1.88         44.7     1.88       44.7 
20 M         35-50     No        87      5.27         50       5.27       50   
21 M         35-50     <NA>       0     NA            50       0          50   
22 M         51-70     Yes       48      2.27         52.3     2.27       52.3 
23 M         51-70     No       103      4.87         57.1     4.87       57.1 
24 M         51-70     <NA>       0     NA            57.1     0          57.1 
25 M         71 +      Yes       23      2.08         59.2     2.08       59.2 
26 M         71 +      No        56      5.06         64.3     5.06       64.3 
27 M         71 +      <NA>       0     NA            64.3     0          64.3 
28 M         (Missing) Yes        3      1.95         66.2     1.95       66.2 
29 M         (Missing) No         8      5.19         71.4     5.19       71.4 
30 M         (Missing) <NA>       0     NA            71.4     0          71.4 
31 (Missing) 18-34     Yes        2      2.86         74.3     2.86       74.3 
32 (Missing) 18-34     No         3      4.29         78.6     4.29       78.6 
33 (Missing) 18-34     <NA>       0     NA            78.6     0          78.6 
34 (Missing) 35-50     Yes        2      2.86         81.4     2.86       81.4 
35 (Missing) 35-50     No         3      4.29         85.7     4.29       85.7 
36 (Missing) 35-50     <NA>       0     NA            85.7     0          85.7 
37 (Missing) 51-70     Yes        3      2.38         88.1     2.38       88.1 
38 (Missing) 51-70     No         6      4.76         92.9     4.76       92.9 
39 (Missing) 51-70     <NA>       0     NA            92.9     0          92.9 
40 (Missing) 71 +      Yes        1      2.38         95.2     2.38       95.2 
41 (Missing) 71 +      No         2      4.76        100       4.76      100   
42 (Missing) 71 +      <NA>       0     NA           100       0         100   

> ff5 %>% tb(2)
# A tibble: 42 x 8
   gender    age.gr    smoker  freq pct_valid pct_valid_cum pct_tot pct_tot_cum
   <fct>     <fct>     <fct>  <dbl>     <dbl>         <dbl>   <dbl>       <dbl>
 1 F         18-34     Yes       34      1.97          1.97    1.97        1.97
 2 F         35-50     Yes       39      2.36          4.34    2.36        4.34
 3 F         51-70     Yes       48      2.18          6.52    2.18        6.52
 4 F         71 +      Yes       21      1.95          8.47    1.95        8.47
 5 F         (Missing) Yes        5      2.55         11.0     2.55       11.0 
 6 M         18-34     Yes       38      2.09         13.1     2.09       13.1 
 7 M         35-50     Yes       31      1.88         15.0     1.88       15.0 
 8 M         51-70     Yes       48      2.27         17.3     2.27       17.3 
 9 M         71 +      Yes       23      2.08         19.3     2.08       19.3 
10 M         (Missing) Yes        3      1.95         21.3     1.95       21.3 
11 (Missing) 18-34     Yes        2      2.86         24.1     2.86       24.1 
12 (Missing) 35-50     Yes        2      2.86         27.0     2.86       27.0 
13 (Missing) 51-70     Yes        3      2.38         29.4     2.38       29.4 
14 (Missing) 71 +      Yes        1      2.38         31.8     2.38       31.8 
15 F         18-34     No        89      5.17         36.9     5.17       36.9 
16 F         35-50     No        79      4.78         41.7     4.78       41.7 
17 F         51-70     No       109      4.96         46.7     4.96       46.7 
18 F         71 +      No        56      5.19         51.9     5.19       51.9 
19 F         (Missing) No         9      4.59         56.5     4.59       56.5 
20 M         18-34     No        92      5.05         61.5     5.05       61.5 
21 M         35-50     No        87      5.27         66.8     5.27       66.8 
22 M         51-70     No       103      4.87         71.6     4.87       71.6 
23 M         71 +      No        56      5.06         76.7     5.06       76.7 
24 M         (Missing) No         8      5.19         81.9     5.19       81.9 
25 (Missing) 18-34     No         3      4.29         86.2     4.29       86.2 
26 (Missing) 35-50     No         3      4.29         90.5     4.29       90.5 
27 (Missing) 51-70     No         6      4.76         95.2     4.76       95.2 
28 (Missing) 71 +      No         2      4.76        100       4.76      100   
29 F         18-34     <NA>       0     NA           100       0         100   
30 F         35-50     <NA>       0     NA           100       0         100   
31 F         51-70     <NA>       0     NA           100       0         100   
32 F         71 +      <NA>       0     NA           100       0         100   
33 F         (Missing) <NA>       0     NA           100       0         100   
34 M         18-34     <NA>       0     NA           100       0         100   
35 M         35-50     <NA>       0     NA           100       0         100   
36 M         51-70     <NA>       0     NA           100       0         100   
37 M         71 +      <NA>       0     NA           100       0         100   
38 M         (Missing) <NA>       0     NA           100       0         100   
39 (Missing) 18-34     <NA>       0     NA           100       0         100   
40 (Missing) 35-50     <NA>       0     NA           100       0         100   
41 (Missing) 51-70     <NA>       0     NA           100       0         100   
42 (Missing) 71 +      <NA>       0     NA           100       0         100   

> ff5 %>% tb(2, na.rm = TRUE)
# A tibble: 28 x 6
   gender    age.gr    smoker  freq   pct pct_cum
   <fct>     <fct>     <fct>  <dbl> <dbl>   <dbl>
 1 F         18-34     Yes       34  1.97    1.97
 2 F         35-50     Yes       39  2.36    4.34
 3 F         51-70     Yes       48  2.18    6.52
 4 F         71 +      Yes       21  1.95    8.47
 5 F         (Missing) Yes        5  2.55   11.0 
 6 M         18-34     Yes       38  2.09   13.1 
 7 M         35-50     Yes       31  1.88   15.0 
 8 M         51-70     Yes       48  2.27   17.3 
 9 M         71 +      Yes       23  2.08   19.3 
10 M         (Missing) Yes        3  1.95   21.3 
11 (Missing) 18-34     Yes        2  2.86   24.1 
12 (Missing) 35-50     Yes        2  2.86   27.0 
13 (Missing) 51-70     Yes        3  2.38   29.4 
14 (Missing) 71 +      Yes        1  2.38   31.8 
15 F         18-34     No        89  5.17   36.9 
16 F         35-50     No        79  4.78   41.7 
17 F         51-70     No       109  4.96   46.7 
18 F         71 +      No        56  5.19   51.9 
19 F         (Missing) No         9  4.59   56.5 
20 M         18-34     No        92  5.05   61.5 
21 M         35-50     No        87  5.27   66.8 
22 M         51-70     No       103  4.87   71.6 
23 M         71 +      No        56  5.06   76.7 
24 M         (Missing) No         8  5.19   81.9 
25 (Missing) 18-34     No         3  4.29   86.2 
26 (Missing) 35-50     No         3  4.29   90.5 
27 (Missing) 51-70     No         6  4.76   95.2 
28 (Missing) 71 +      No         2  4.76  100   

# -----------------  drop.var.col argument
> tb(descr(iris$Sepal.Length), drop.var.col = TRUE)
# A tibble: 1 x 15
   mean    sd   min    q1   med    q3   max   mad   iqr    cv skewness se.skewness kurtosis n.valid pct.valid
  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
1  5.84 0.828   4.3   5.1   5.8   6.4   7.9  1.04   1.3 0.142    0.309       0.198   -0.606     150       100

# -----------------  drop.var.col should be ignored here
> tb(stby(tobacco, tobacco$gender, descr), drop.var.col = TRUE)
# A tibble: 12 x 17
   gender    variable      mean      sd    min     q1   med    q3   max      mad      iqr     cv skewness se.skewness kurtosis n.valid pct.valid
   <fct>     <chr>        <dbl>   <dbl>  <dbl>  <dbl> <dbl> <dbl> <dbl>    <dbl>    <dbl>  <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
 1 F         age          49.6  18.3    18     34     50    66    80    23.7     32       0.369   -0.0355       0.112  -1.25       475      97.1
 2 F         BMI          26.1   4.95    9.01  23.0   25.9  29.5  39.4   4.75     6.49    0.190   -0.0226       0.112   0.0891     475      97.1
 3 F         cigs.per.day  6.88 12.0     0      0      0    10.5  40     0       10.2     1.75     1.53         0.113   0.855      468      95.7
 4 F         samp.wgts     1.00  0.0840  0.861  0.861  1.04  1.05  1.06  0.00772  0.188   0.0840  -1.03         0.110  -0.918      489     100  
 5 M         age          49.6  18.3    18     34     49.5  66    80    24.5     32       0.370   -0.0403       0.112  -1.27       478      97.8
 6 M         BMI          25.3   3.98    8.83  22.5   25.1  28.0  36.8   4.02     5.44    0.157   -0.0372       0.112   0.175      477      97.5
 7 M         cigs.per.day  6.72 11.8     0      0      0    11    40     0       11       1.76     1.54         0.112   0.921      475      97.1
 8 M         samp.wgts     1.00  0.0840  0.861  0.861  1.04  1.05  1.06  0.00772  0.188   0.0840  -1.03         0.110  -0.918      489     100  
 9 (Missing) age          50.9  18.2    19     36     55.5  64    80    23.0     27.2     0.358   -0.127        0.491  -1.36        22     100  
10 (Missing) BMI          26.9   3.51   20.2   25.0   27.2  30.2  32.4   4.07     5.06    0.130   -0.343        0.491  -0.925       22     100  
11 (Missing) cigs.per.day  6.09  9.72    0      0      0    10    28     0        8.75    1.60     1.13         0.491  -0.436       22     100  
12 (Missing) samp.wgts     1.01  0.0811  0.861  1.04   1.05  1.05  1.06  0.00772  0.00521 0.0806  -1.20         0.491  -0.560       22     100  

# -----------------  order & swap combination
> tb(stby(tobacco, tobacco$gender, descr), order = 3)
# A tibble: 12 x 17
   variable     gender     mean      sd    min     q1   med    q3   max      mad      iqr     cv skewness se.skewness kurtosis n.valid pct.valid
   <chr>        <fct>     <dbl>   <dbl>  <dbl>  <dbl> <dbl> <dbl> <dbl>    <dbl>    <dbl>  <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
 1 age          F         49.6  18.3    18     34     50    66    80    23.7     32       0.369   -0.0355       0.112  -1.25       475      97.1
 2 age          M         49.6  18.3    18     34     49.5  66    80    24.5     32       0.370   -0.0403       0.112  -1.27       478      97.8
 3 age          (Missing) 50.9  18.2    19     36     55.5  64    80    23.0     27.2     0.358   -0.127        0.491  -1.36        22     100  
 4 BMI          F         26.1   4.95    9.01  23.0   25.9  29.5  39.4   4.75     6.49    0.190   -0.0226       0.112   0.0891     475      97.1
 5 BMI          M         25.3   3.98    8.83  22.5   25.1  28.0  36.8   4.02     5.44    0.157   -0.0372       0.112   0.175      477      97.5
 6 BMI          (Missing) 26.9   3.51   20.2   25.0   27.2  30.2  32.4   4.07     5.06    0.130   -0.343        0.491  -0.925       22     100  
 7 cigs.per.day F          6.88 12.0     0      0      0    10.5  40     0       10.2     1.75     1.53         0.113   0.855      468      95.7
 8 cigs.per.day M          6.72 11.8     0      0      0    11    40     0       11       1.76     1.54         0.112   0.921      475      97.1
 9 cigs.per.day (Missing)  6.09  9.72    0      0      0    10    28     0        8.75    1.60     1.13         0.491  -0.436       22     100  
10 samp.wgts    F          1.00  0.0840  0.861  0.861  1.04  1.05  1.06  0.00772  0.188   0.0840  -1.03         0.110  -0.918      489     100  
11 samp.wgts    M          1.00  0.0840  0.861  0.861  1.04  1.05  1.06  0.00772  0.188   0.0840  -1.03         0.110  -0.918      489     100  
12 samp.wgts    (Missing)  1.01  0.0811  0.861  1.04   1.05  1.05  1.06  0.00772  0.00521 0.0806  -1.20         0.491  -0.560       22     100  

> tb(stby(tobacco, list(tobacco$gender, tobacco$smoker), descr), order = 3)
# A tibble: 24 x 18
   variable     gender    smoker   mean      sd    min     q1   med    q3   max      mad      iqr       cv skewness se.skewness kurtosis n.valid pct.valid
   <chr>        <fct>     <fct>   <dbl>   <dbl>  <dbl>  <dbl> <dbl> <dbl> <dbl>    <dbl>    <dbl>    <dbl>    <dbl>       <dbl>    <dbl>   <dbl>     <dbl>
 1 age          F         Yes    49.1   18.3    19     35     50    64    80    20.8     28.8       0.373   -0.0270       0.203   -1.20      142      96.6
 2 age          F         No     49.7   18.3    18     34     50    67    80    23.7     33         0.367   -0.0390       0.134   -1.29      333      97.4
 3 age          M         Yes    50.5   19.3    19     33     52.5  67    80    23.0     33.5       0.381   -0.164        0.205   -1.33      140      97.9
 4 age          M         No     49.2   18.0    18     34     49    64    80    22.2     30         0.365    0.0139       0.133   -1.25      338      97.7
 5 age          (Missing) Yes    47.9   18.7    24     33     45.5  63.5  75    20.8     26.2       0.390    0.165        0.752   -1.76        8     100  
 6 age          (Missing) No     52.6   18.5    19     38     59    64    80    19.3     24.8       0.351   -0.297        0.597   -1.24       14     100  
 7 BMI          F         Yes    25.9    4.38    9.01  23.1   26.0  28.1  36.4   4.28     5.06      0.169   -0.270        0.202    0.793     144      98.0
 8 BMI          F         No     26.2    5.18   10.3   22.9   25.8  29.9  39.4   5.15     6.91      0.198    0.0296       0.134   -0.168     331      96.8
 9 BMI          M         Yes    25.3    4.17   16.0   22.3   24.9  28.4  35.2   4.11     5.91      0.165    0.119        0.206   -0.495     139      97.2
10 BMI          M         No     25.3    3.91    8.83  22.8   25.2  27.9  36.8   3.91     5.03      0.154   -0.113        0.133    0.497     338      97.7
11 BMI          (Missing) Yes    27.2    2.48   24.2   25.1   26.9  29.1  31.2   2.73     3.64      0.0912   0.271        0.752   -1.64        8     100  
12 BMI          (Missing) No     26.8    4.07   20.2   24.0   27.2  30.4  32.4   4.74     5.96      0.152   -0.315        0.597   -1.36       14     100  
13 cigs.per.day F         Yes    22.5   11.1     5     13     22    33    40    14.8     20         0.492   -0.0274       0.203   -1.38      143      97.3
14 cigs.per.day F         No      0      0       0      0      0     0     0     0        0       NaN      NaN            0.135  NaN         325      95.0
15 cigs.per.day M         Yes    22.8   10.4     5     14     22.5  32    40    14.1     18         0.454    0.0424       0.205   -1.28      140      97.9
16 cigs.per.day M         No      0      0       0      0      0     0     0     0        0       NaN      NaN            0.133  NaN         335      96.8
17 cigs.per.day (Missing) Yes    16.8    8.92    5      7.5   20    23    28     9.64    13.2       0.533   -0.247        0.752   -1.79        8     100  
18 cigs.per.day (Missing) No      0      0       0      0      0     0     0     0        0       NaN      NaN            0.597  NaN          14     100  
19 samp.wgts    F         Yes     1.00   0.0824  0.861  0.861  1.04  1.05  1.06  0.00772  0.0966    0.0822  -1.12         0.200   -0.733     147     100  
20 samp.wgts    F         No      0.999  0.0848  0.861  0.861  1.04  1.05  1.06  0.00772  0.188     0.0849  -0.988        0.132   -1.00      342     100  
21 samp.wgts    M         Yes     0.999  0.0848  0.861  0.861  1.04  1.05  1.06  0.00772  0.188     0.0848  -0.994        0.203   -0.994     143     100  
22 samp.wgts    M         No      1.00   0.0838  0.861  0.861  1.04  1.05  1.06  0.00772  0.188     0.0838  -1.04         0.131   -0.898     346     100  
23 samp.wgts    (Missing) Yes     1.00   0.0874  0.861  0.953  1.05  1.05  1.06  0.00386  0.0509    0.0872  -0.933        0.752   -1.22        8     100  
24 samp.wgts    (Missing) No      1.01   0.0806  0.861  1.04   1.05  1.05  1.06  0.00772  0.00521   0.0799  -1.23         0.597   -0.483      14     100  

> st_options("reset")
summarytools options have been reset

> detach("package:summarytools")

> detach("package:dplyr")

> detach("package:magrittr")
